            refreshDashboard() {
                document.getElementById('totalClients').textContent = this.clients.length;
                
                const upcoming = this.appointments.filter(apt => apt.status === 'upcoming');
                document.getElementById('upcomingAppointments').textContent = upcoming.length;
                
                // Calculate monthly revenue
                const currentMonth = new Date().getMonth();
                const monthlyAppointments = this.appointments.filter(apt => {
                    const aptDate = new Date(apt.date);
                    return aptDate.getMonth() === currentMonth && apt.status === 'completed';
                });
                const monthlyRevenue = monthlyAppointments.reduce((sum, apt) => sum + (apt.price || 0), 0);
                document.getElementById('monthlyRevenue').textContent = `$${monthlyRevenue}`;
                
                // Low stock items
                const lowStock = this.inventory.filter(item => item.quantity <= item.minStock);
                document.getElementById('lowStockItems').textContent = lowStock.length;
                
                // Today's appointments
                this.refreshTodaysAppointments();
            }

            refreshTodaysAppointments() {
                const today = new Date().toISOString().split('T')[0];
                const todaysAppointments = this.appointments.filter(apt => apt.date === today && apt.status === 'upcoming');
                const container = document.getElementById('todaysAppointments');
                
                if (todaysAppointments.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-calendar-times"></i>
                            <h3 data-i18n="no_appointments_today">No Appointments Today</h3>
                            <p data-i18n="schedule_clear">Your schedule is clear for today</p>
                            <button class="btn btn-primary mt-1" onclick="app.showSection('appointments')">
                                <i class="fas fa-plus"></i>
                                <span data-i18n="schedule_appointment">Schedule Appointment</span>
                            </button>
                        </div>
                    `;
                    this.translatePage();
                } else {
                    container.innerHTML = todaysAppointments.map(apt => `
                        <div class="list-item">
                            <div class="item-header">
                                <div class="item-title">${apt.clientName}</div>
                                <div class="item-actions">
                                    <button class="btn btn-sm" onclick="app.completeAppointment('${apt.id}')">
                                        <i class="fas fa-check"></i>
                                    </button>
                                    <button class="btn btn-sm" onclick="app.cancelAppointment('${apt.id}')">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="item-details">
                                <div>${apt.service} - $${apt.price}</div>
                                <div>${apt.time}</div>
                            </div>
                        </div>
                    `).join('');
                }
            }

            refreshClients() {
                const container = document.getElementById('clientsList');
                
                if (this.clients.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-users"></i>
                            <h3 data-i18n="no_clients_yet">No Clients Yet</h3>
                            <p data-i18n="build_client_database">Start building your client database</p>
                            <button class="btn btn-primary mt-1" id="addFirstClient">
                                <i class="fas fa-plus"></i>
                                <span data-i18n="add_first_client">Add First Client</span>
                            </button>
                        </div>
                    `;
                    document.getElementById('addFirstClient').addEventListener('click', () => this.addClient());
                } else {
                    container.innerHTML = this.clients.map(client => `
                        <div class="list-item">
                            <div class="item-header">
                                <div class="item-title">${client.name}</div>
                                <div class="item-actions">
                                    <button class="btn btn-sm" onclick="app.editClient('${client.id}')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-sm" onclick="app.deleteClient('${client.id}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="item-details">
                                <div>${client.phone || 'No phone'}</div>
                                <div>${client.email || 'No email'}</div>
                            </div>
                        </div>
                    `).join('');
                }
                this.translatePage();
            }

            refreshAppointments() {
                const container = document.getElementById('appointmentsList');
                const upcomingAppointments = this.appointments.filter(apt => apt.status === 'upcoming')
                    .sort((a, b) => new Date(a.date + ' ' + a.time) - new Date(b.date + ' ' + b.time));
                
                if (upcomingAppointments.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-calendar-plus"></i>
                            <h3 data-i18n="no_appointments_scheduled">No Appointments</h3>
                            <p data-i18n="schedule_first_appointment">Schedule your first appointment</p>
                            <button class="btn btn-primary mt-1" id="addFirstAppointment">
                                <i class="fas fa-plus"></i>
                                <span data-i18n="create_first_appointment">Create Appointment</span>
                            </button>
                        </div>
                    `;
                    document.getElementById('addFirstAppointment').addEventListener('click', () => this.addAppointment());
                } else {
                    container.innerHTML = upcomingAppointments.map(apt => `
                        <div class="list-item">
                            <div class="item-header">
                                <div class="item-title">${apt.clientName}</div>
                                <div class="item-actions">
                                    <button class="btn btn-sm" onclick="app.completeAppointment('${apt.id}')">
                                        <i class="fas fa-check"></i>
                                    </button>
                                    <button class="btn btn-sm" onclick="app.cancelAppointment('${apt.id}')">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="item-details">
                                <div>${apt.service} - $${apt.price}</div>
                                <div>${new Date(apt.date).toLocaleDateString()} at ${apt.time}</div>
                                <div>${apt.notes || ''}</div>
                            </div>
                        </div>
                    `).join('');
                }
                this.translatePage();
            }

            refreshServices() {
                const container = document.getElementById('servicesList');
                
                if (this.services.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-cut"></i>
                            <h3 data-i18n="no_services">No Services</h3>
                            <p data-i18n="add_services">Add your services and pricing</p>
                            <button class="btn btn-primary mt-1" id="addFirstService">
                                <i class="fas fa-plus"></i>
                                <span data-i18n="add_first_service">Add Service</span>
                            </button>
                        </div>
                    `;
                    document.getElementById('addFirstService').addEventListener('click', () => this.addService());
                } else {
                    container.innerHTML = this.services.map(service => `
                        <div class="list-item">
                            <div class="item-header">
                                <div class="item-title">${service.name}</div>
                                <div class="item-actions">
                                    <button class="btn btn-sm" onclick="app.editService('${service.id}')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-sm" onclick="app.deleteService('${service.id}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="item-details">
                                <div>$${service.price} - ${service.duration} minutes</div>
                            </div>
                        </div>
                    `).join('');
                }
                this.translatePage();
            }

            refreshInventory() {
                const container = document.getElementById('inventoryList');
                
                if (this.inventory.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-box-open"></i>
                            <h3 data-i18n="no_products">No Products</h3>
                            <p data-i18n="track_products">Track your products and supplies</p>
                            <button class="btn btn-primary mt-1" id="addFirstProduct">
                                <i class="fas fa-plus"></i>
                                <span data-i18n="add_first_product">Add Product</span>
                            </button>
                        </div>
                    `;
                    document.getElementById('addFirstProduct').addEventListener('click', () => this.addProduct());
                } else {
                    container.innerHTML = this.inventory.map(item => `
                        <div class="list-item ${item.quantity <= item.minStock ? 'border-left-color: var(--danger);' : ''}">
                            <div class="item-header">
                                <div class="item-title">${item.name}</div>
                                <div class="item-actions">
                                    <button class="btn btn-sm" onclick="app.editProduct('${item.id}')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-sm" onclick="app.deleteProduct('${item.id}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="item-details">
                                <div>Quantity: ${item.quantity} ${item.quantity <= item.minStock ? '(Low Stock!)' : ''}</div>
                                <div>Cost: $${item.cost} | Price: $${item.price}</div>
                            </div>
                        </div>
                    `).join('');
                }
                this.translatePage();
            }

            refreshReports() {
                const totalAppointments = this.appointments.length;
                const completedAppointments = this.appointments.filter(apt => apt.status === 'completed');
                const totalRevenue = completedAppointments.reduce((sum, apt) => sum + (apt.price || 0), 0);
                const avgPrice = completedAppointments.length > 0 ? Math.round(totalRevenue / completedAppointments.length) : 0;
                
                // Simple retention calculation (clients with more than 1 appointment)
                const clientAppointmentCount = {};
                this.appointments.forEach(apt => {
                    clientAppointmentCount[apt.clientId] = (clientAppointmentCount[apt.clientId] || 0) + 1;
                });
                const returningClients = Object.values(clientAppointmentCount).filter(count => count > 1).length;
                const retentionRate = this.clients.length > 0 ? Math.round((returningClients / this.clients.length) * 100) : 0;

                document.getElementById('totalAppointmentsReport').textContent = totalAppointments;
                document.getElementById('totalRevenueReport').textContent = `$${totalRevenue}`;
                document.getElementById('avgAppointmentPrice').textContent = `$${avgPrice}`;
                document.getElementById('clientRetention').textContent = `${retentionRate}%`;
            }

            // CRUD Operations
            addClient() {
                const name = prompt('Enter client name:');
                if (name) {
                    const client = {
                        id: Date.now().toString(),
                        name: name,
                        phone: prompt('Enter phone:') || '',
                        email: prompt('Enter email:') || '',
                        notes: prompt('Enter notes:') || '',
                        createdAt: new Date().toISOString()
                    };
                    this.clients.push(client);
                    this.saveData();
                    this.refreshClients();
                    this.refreshDashboard();
                    this.showToast('Client added successfully!');
                }
            }

            editClient(id) {
                const client = this.clients.find(c => c.id === id);
                if (client) {
                    const name = prompt('Enter client name:', client.name);
                    if (name) {
                        client.name = name;
                        client.phone = prompt('Enter phone:', client.phone) || '';
                        client.email = prompt('Enter email:', client.email) || '';
                        client.notes = prompt('Enter notes:', client.notes) || '';
                        this.saveData();
                        this.refreshClients();
                        this.showToast('Client updated successfully!');
                    }
                }
            }

            deleteClient(id) {
                if (confirm('Are you sure you want to delete this client?')) {
                    this.clients = this.clients.filter(c => c.id !== id);
                    // Also remove client's appointments
                    this.appointments = this.appointments.filter(apt => apt.clientId !== id);
                    this.saveData();
                    this.refreshClients();
                    this.refreshAppointments();
                    this.refreshDashboard();
                    this.showToast('Client deleted successfully!');
                }
            }

            addAppointment() {
                if (this.clients.length === 0) {
                    alert('Please add a client first!');
                    this.showSection('clients');
                    return;
                }

                const clientId = prompt('Enter client ID (or select from clients list):');
                const client = this.clients.find(c => c.id === clientId) || this.clients[0];
                
                const service = prompt('Enter service:', 'Hair Cut');
                const date = prompt('Enter date (YYYY-MM-DD):', new Date().toISOString().split('T')[0]);
                const time = prompt('Enter time (HH:MM):', '10:00');
                const price = prompt('Enter price:', '45');
                const notes = prompt('Enter notes:', '');

                if (client && service && date && time) {
                    const appointment = {
                        id: Date.now().toString(),
                        clientId: client.id,
                        clientName: client.name,
                        service: service,
                        date: date,
                        time: time,
                        price: parseFloat(price) || 0,
                        notes: notes,
                        status: 'upcoming',
                        createdAt: new Date().toISOString()
                    };
                    this.appointments.push(appointment);
                    this.saveData();
                    this.refreshAppointments();
                    this.refreshDashboard();
                    this.showToast('Appointment scheduled successfully!');
                }
            }

            completeAppointment(id) {
                const appointment = this.appointments.find(apt => apt.id === id);
                if (appointment) {
                    appointment.status = 'completed';
                    this.saveData();
                    this.refreshAppointments();
                    this.refreshDashboard();
                    this.showToast('Appointment completed!');
                }
            }

            cancelAppointment(id) {
                if (confirm('Are you sure you want to cancel this appointment?')) {
                    this.appointments = this.appointments.filter(apt => apt.id !== id);
                    this.saveData();
                    this.refreshAppointments();
                    this.refreshDashboard();
                    this.showToast('Appointment cancelled!');
                }
            }

            addService() {
                const name = prompt('Enter service name:');
                if (name) {
                    const service = {
                        id: Date.now().toString(),
                        name: name,
                        price: parseFloat(prompt('Enter price:', '0')) || 0,
                        duration: parseInt(prompt('Enter duration (minutes):', '30')) || 30
                    };
                    this.services.push(service);
                    this.saveData();
                    this.refreshServices();
                    this.showToast('Service added successfully!');
                }
            }

            editService(id) {
                const service = this.services.find(s => s.id === id);
                if (service) {
                    const name = prompt('Enter service name:', service.name);
                    if (name) {
                        service.name = name;
                        service.price = parseFloat(prompt('Enter price:', service.price)) || 0;
                        service.duration = parseInt(prompt('Enter duration (minutes):', service.duration)) || 30;
                        this.saveData();
                        this.refreshServices();
                        this.showToast('Service updated successfully!');
                    }
                }
            }

            deleteService(id) {
                if (confirm('Are you sure you want to delete this service?')) {
                    this.services = this.services.filter(s => s.id !== id);
                    this.saveData();
                    this.refreshServices();
                    this.showToast('Service deleted successfully!');
                }
            }

            addProduct() {
                const name = prompt('Enter product name:');
                if (name) {
                    const product = {
                        id: Date.now().toString(),
                        name: name,
                        quantity: parseInt(prompt('Enter quantity:', '0')) || 0,
                        minStock: parseInt(prompt('Enter minimum stock level:', '5')) || 5,
                        cost: parseFloat(prompt('Enter cost:', '0')) || 0,
                        price: parseFloat(prompt('Enter price:', '0')) || 0
                    };
                    this.inventory.push(product);
                    this.saveData();
                    this.refreshInventory();
                    this.refreshDashboard();
                    this.showToast('Product added successfully!');
                }
            }

            editProduct(id) {
                const product = this.inventory.find(p => p.id === id);
                if (product) {
                    const name = prompt('Enter product name:', product.name);
                    if (name) {
                        product.name = name;
                        product.quantity = parseInt(prompt('Enter quantity:', product.quantity)) || 0;
                        product.minStock = parseInt(prompt('Enter minimum stock level:', product.minStock)) || 5;
                        product.cost = parseFloat(prompt('Enter cost:', product.cost)) || 0;
                        product.price = parseFloat(prompt('Enter price:', product.price)) || 0;
                        this.saveData();
                        this.refreshInventory();
                        this.refreshDashboard();
                        this.showToast('Product updated successfully!');
                    }
                }
            }

            deleteProduct(id) {
                if (confirm('Are you sure you want to delete this product?')) {
                    this.inventory = this.inventory.filter(p => p.id !== id);
                    this.saveData();
                    this.refreshInventory();
                    this.refreshDashboard();
                    this.showToast('Product deleted successfully!');
                }
            }

            exportData() {
                const data = {
                    clients: this.clients,
                    appointments: this.appointments,
                    services: this.services,
                    inventory: this.inventory,
                    exportedAt: new Date().toISOString()
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `stylistmanager-backup-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                this.showToast('Data exported successfully!');
            }

            saveData() {
                localStorage.setItem('clients', JSON.stringify(this.clients));
                localStorage.setItem('appointments', JSON.stringify(this.appointments));
                localStorage.setItem('services', JSON.stringify(this.services));
                localStorage.setItem('inventory', JSON.stringify(this.inventory));
            }

            showToast(message) {
                const toast = document.getElementById('toast');
                toast.textContent = message;
                toast.classList.add('show');
                setTimeout(() => {
                    toast.classList.remove('show');
                }, 3000);
            }

            initPWA() {
                let deferredPrompt;
                const installBtn = document.getElementById('pwaInstallBtn');

                window.addEventListener('beforeinstallprompt', (e) => {
                    e.preventDefault();
                    deferredPrompt = e;
                    installBtn.classList.add('show');
                });

                installBtn.addEventListener('click', async () => {
                    if (deferredPrompt) {
                        deferredPrompt.prompt();
                        const { outcome } = await deferredPrompt.userChoice;
                        if (outcome === 'accepted') {
                            installBtn.classList.remove('show');
                        }
                        deferredPrompt = null;
                    }
                });

                window.addEventListener('appinstalled', () => {
                    installBtn.classList.remove('show');
                    deferredPrompt = null;
                });
            }
        }

        // Initialize the app
        const app = new StylistManagerPro();
    </script>
</body>
</html>
