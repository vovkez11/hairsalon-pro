<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HairSalon Pro - Professional Hairdresser Management</title>
    <meta name="description" content="Complete hairdresser salon management system for professional stylists">
    <meta name="theme-color" content="#e91e63">
    
    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Permanent+Marker&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
<style>
    :root {
        --primary: #e91e63;
        --primary-dark: #c2185b;
        --primary-light: #f8bbd9;
        --secondary: #9c27b0;
        --accent: #ff9800;
        --dark: #0d1117;
        --darker: #010409;
        --dark-gray: #161b22;
        --light: #f5f5f5;
        --success: #4caf50;
        --warning: #ff9800;
        --danger: #f44336;
        --border-radius: 16px;
        --shadow: 0 12px 40px rgba(0,0,0,0.4);
        --transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Roboto', sans-serif;
        background: linear-gradient(135deg, var(--darker) 0%, var(--dark) 100%);
        color: var(--light);
        line-height: 1.7;
        min-height: 100vh;
        padding: 0;
        overflow-x: hidden;
        display: flex;
    }

    /* Sidebar Navigation */
    #sidebar {
        width: 280px;
        background: linear-gradient(180deg, var(--dark-gray) 0%, var(--darker) 100%);
        border-right: 1px solid #30363d;
        padding: 2rem 0;
        display: flex;
        flex-direction: column;
        position: sticky;
        top: 0;
        height: 100vh;
        box-shadow: 2px 0 20px rgba(0,0,0,0.6);
        z-index: 1000;
    }

    .logo {
        font-family: 'Permanent Marker', cursive;
        color: var(--primary);
        font-size: 2rem;
        text-align: center;
        margin-bottom: 3rem;
        text-shadow: 0 0 15px rgba(233, 30, 99, 0.5);
        letter-spacing: 1.5px;
        padding: 0 1.5rem;
    }

    .nav-section {
        margin-bottom: 2rem;
    }

    .nav-section-title {
        color: var(--primary);
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        padding: 0 2rem;
        margin-bottom: 1rem;
        opacity: 0.7;
        font-weight: 600;
    }

    .nav-link {
        display: flex;
        align-items: center;
        padding: 1rem 2rem;
        color: var(--light);
        text-decoration: none;
        font-weight: 600;
        transition: var(--transition);
        border-left: 4px solid transparent;
        margin: 0.15rem 0;
        cursor: pointer;
    }

    .nav-link:hover {
        background: linear-gradient(90deg, rgba(233, 30, 99, 0.1) 0%, transparent 100%);
        color: var(--primary);
        border-left-color: var(--primary);
    }

    .nav-link.active {
        background: linear-gradient(90deg, rgba(233, 30, 99, 0.15) 0%, transparent 100%);
        color: var(--primary);
        border-left-color: var(--primary);
    }

    .nav-link i {
        margin-right: 15px;
        font-size: 1.3rem;
        width: 20px;
        text-align: center;
    }

    /* Language Selector */
    .language-selector {
        padding: 0 2rem;
        margin-top: auto;
        margin-bottom: 1rem;
    }

    .language-selector select {
        width: 100%;
        padding: 10px;
        background: var(--dark);
        border: 1px solid #30363d;
        border-radius: 8px;
        color: var(--light);
        font-size: 0.9rem;
    }

    /* Main Content Area */
    .app-container {
        flex-grow: 1;
        max-width: calc(100% - 280px);
        padding: 20px;
        overflow-y: auto;
    }

    /* Header */
    .app-header {
        background: linear-gradient(135deg, var(--dark) 0%, var(--dark-gray) 100%);
        padding: 25px;
        text-align: center;
        border-radius: var(--border-radius);
        margin-bottom: 25px;
        box-shadow: var(--shadow);
        border: 1px solid rgba(255,255,255,0.1);
        position: relative;
        overflow: hidden;
    }

    .app-header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent));
    }

    .tagline {
        color: var(--primary-light);
        font-size: 1.2em;
        opacity: 0.9;
        margin-bottom: 20px;
        font-weight: 300;
    }

    /* Install Button */
    .install-btn {
        background: linear-gradient(135deg, var(--success) 0%, #66bb6a 100%);
        color: white;
        border: none;
        padding: 14px 28px;
        border-radius: var(--border-radius);
        cursor: pointer;
        font-weight: 600;
        transition: var(--transition);
        display: none;
        box-shadow: 0 6px 20px rgba(76, 175, 80, 0.3);
        min-height: 50px;
        min-width: 140px;
        position: relative;
        overflow: hidden;
    }

    .install-btn.pulse {
        animation: pulse 2s infinite;
    }

    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }

    .install-btn:hover {
        transform: translateY(-3px) scale(1.05);
        box-shadow: 0 10px 30px rgba(76, 175, 80, 0.4);
    }

    /* Install Prompt */
    .install-prompt {
        position: fixed;
        bottom: 30px;
        left: 50%;
        transform: translateX(-50%);
        background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        color: var(--darker);
        padding: 20px 25px;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        z-index: 1000;
        display: none;
        gap: 20px;
        align-items: center;
        flex-wrap: wrap;
        justify-content: center;
        max-width: 90%;
        animation: toastSlideUp 0.4s ease;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255,255,255,0.2);
        font-weight: 600;
    }

    .install-prompt.show {
        display: flex;
    }

    /* Sections */
    .section {
        display: none;
        animation: fadeInUp 0.6s ease;
    }

    .section.active {
        display: block;
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Cards */
    .card {
        background: linear-gradient(135deg, var(--dark-gray) 0%, #2d2d2d 100%);
        border-radius: var(--border-radius);
        padding: 25px;
        margin-bottom: 20px;
        box-shadow: var(--shadow);
        border: 1px solid rgba(255,255,255,0.08);
        transition: var(--transition);
        position: relative;
        overflow: hidden;
    }

    .card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, var(--primary), var(--secondary));
        transform: scaleX(0);
        transition: var(--transition);
    }

    .card:hover::before {
        transform: scaleX(1);
    }

    .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 40px rgba(0,0,0,0.5);
    }

    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 2px solid var(--primary);
    }

    .card-title {
        font-size: 1.5em;
        color: var(--primary);
        display: flex;
        align-items: center;
        gap: 12px;
        font-weight: 700;
        cursor: pointer;
        transition: var(--transition);
        padding: 8px 16px;
        border-radius: 10px;
    }

    .card-title:hover {
        background: rgba(233, 30, 99, 0.1);
        transform: translateX(5px);
    }

    /* Buttons */
    .btn {
        padding: 14px 24px;
        border: none;
        border-radius: var(--border-radius);
        cursor: pointer;
        font-weight: 600;
        transition: var(--transition);
        display: inline-flex;
        align-items: center;
        gap: 8px;
        font-size: 1em;
        position: relative;
        overflow: hidden;
        min-height: 44px;
        min-width: 44px;
    }

    .btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transition: var(--transition);
    }

    .btn:hover::before {
        left: 100%;
    }

    .btn-primary {
        background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
        color: var(--darker);
        box-shadow: 0 6px 20px rgba(233, 30, 99, 0.3);
    }

    .btn-primary:hover {
        transform: translateY(-3px) scale(1.05);
        box-shadow: 0 10px 30px rgba(233, 30, 99, 0.4);
    }

    .btn-success {
        background: linear-gradient(135deg, var(--success) 0%, #66bb6a 100%);
        color: white;
    }

    .btn-danger {
        background: linear-gradient(135deg, var(--danger) 0%, #ef5350 100%);
        color: white;
    }

    .btn-warning {
        background: linear-gradient(135deg, var(--warning) 0%, #ffb74d 100%);
        color: var(--darker);
    }

    .btn-outline {
        background: transparent;
        border: 2px solid var(--primary);
        color: var(--primary);
    }

    .btn-outline:hover {
        background: var(--primary);
        color: var(--darker);
        transform: translateY(-2px);
    }

    .btn:active {
        transform: scale(0.95);
        transition: transform 0.1s;
    }

    /* Form Dropdown Styling */
    select.form-control {
        background: linear-gradient(135deg, var(--dark) 0%, #222 100%) !important;
        color: var(--light) !important;
        border: 2px solid rgba(255,255,255,0.1) !important;
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23e91e63' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E") !important;
        background-repeat: no-repeat !important;
        background-position: right 16px center !important;
        background-size: 16px !important;
        padding-right: 45px !important;
    }

    select.form-control:focus {
        border-color: var(--primary) !important;
        box-shadow: 0 0 0 4px rgba(233, 30, 99, 0.15) !important;
        outline: none !important;
    }

    select.form-control option {
        background: var(--dark) !important;
        color: var(--light) !important;
        padding: 12px !important;
    }

    /* Forms */
    .form-group {
        margin-bottom: 20px;
    }

    .form-label {
        display: block;
        margin-bottom: 8px;
        color: var(--primary);
        font-weight: 600;
        font-size: 1em;
    }

    .form-control {
        width: 100%;
        padding: 16px;
        border: 2px solid rgba(255,255,255,0.1);
        border-radius: var(--border-radius);
        background: linear-gradient(135deg, var(--dark) 0%, #222 100%);
        color: var(--light);
        font-size: 16px;
        transition: var(--transition);
        font-family: inherit;
        min-height: 50px;
    }

    .form-control:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 4px rgba(233, 30, 99, 0.15);
        transform: translateY(-2px);
    }

    /* Products Used Section */
    .products-section {
        background: rgba(233, 30, 99, 0.05);
        border: 1px solid rgba(233, 30, 99, 0.2);
        border-radius: var(--border-radius);
        padding: 20px;
        margin: 20px 0;
    }

    .products-grid {
        display: grid;
        grid-template-columns: 2fr 1fr auto;
        gap: 10px;
        align-items: end;
        margin-bottom: 15px;
    }

    .product-item {
        display: grid;
        grid-template-columns: 2fr 1fr auto;
        gap: 10px;
        align-items: center;
        padding: 12px;
        background: rgba(255,255,255,0.05);
        border-radius: 8px;
        margin-bottom: 8px;
        animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateX(-10px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    .product-qty {
        width: 80px;
        text-align: center;
    }

    .remove-product {
        background: var(--danger);
        color: white;
        border: none;
        border-radius: 6px;
        padding: 8px 12px;
        cursor: pointer;
        transition: var(--transition);
    }

    .remove-product:hover {
        transform: scale(1.1);
    }

    /* Stats Grid */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin: 25px 0;
    }

    .stat-card {
        background: linear-gradient(135deg, var(--dark) 0%, var(--dark-gray) 100%);
        padding: 25px;
        text-align: center;
        border-radius: var(--border-radius);
        border-left: 5px solid var(--primary);
        transition: var(--transition);
        cursor: pointer;
        position: relative;
        overflow: hidden;
    }

    .stat-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, rgba(233, 30, 99, 0.1) 0%, transparent 100%);
        opacity: 0;
        transition: var(--transition);
    }

    .stat-card:hover::before {
        opacity: 1;
    }

    .stat-card:hover {
        transform: translateY(-8px) scale(1.03);
        box-shadow: var(--shadow);
        border-left-color: var(--secondary);
    }

    .stat-value {
        font-size: 2.5em;
        font-weight: bold;
        color: var(--primary);
        margin-bottom: 8px;
        line-height: 1;
        text-shadow: 0 4px 15px rgba(233, 30, 99, 0.3);
    }

    .stat-label {
        color: var(--light);
        opacity: 0.9;
        font-size: 0.95em;
        font-weight: 600;
    }

    /* Lists */
    .client-item, .appointment-item, .inventory-item {
        display: flex;
        justify-content: space-between;
        align-items: start;
        padding: 20px;
        border-bottom: 1px solid rgba(255,255,255,0.1);
        transition: var(--transition);
        cursor: pointer;
        border-radius: 12px;
        margin-bottom: 10px;
        background: linear-gradient(135deg, rgba(42,42,42,0.8) 0%, rgba(50,50,50,0.6) 100%);
    }

    .client-item:hover, .appointment-item:hover, .inventory-item:hover {
        background: linear-gradient(135deg, rgba(233, 30, 99, 0.15) 0%, rgba(156, 39, 176, 0.1) 100%);
        transform: translateX(10px) scale(1.02);
        box-shadow: 0 8px 25px rgba(0,0,0,0.3);
    }

    .item-content {
        flex: 1;
    }

    .item-title {
        font-size: 1.2em;
        font-weight: 700;
        color: var(--light);
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .item-meta {
        color: rgba(255,255,255,0.8);
        font-size: 0.9em;
        line-height: 1.6;
    }

    .item-actions {
        display: flex;
        gap: 8px;
        opacity: 0;
        transition: var(--transition);
    }

    .client-item:hover .item-actions,
    .appointment-item:hover .item-actions,
    .inventory-item:hover .item-actions {
        opacity: 1;
    }

    .action-btn {
        padding: 10px 12px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 0.85em;
        transition: var(--transition);
        backdrop-filter: blur(10px);
        min-height: 44px;
        min-width: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .action-btn:hover {
        transform: scale(1.1);
    }

    /* Calendar */
    .calendar-controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        flex-wrap: wrap;
        gap: 15px;
    }

    .calendar-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 2px;
        background: rgba(255,255,255,0.1);
        border: 1px solid rgba(255,255,255,0.1);
        border-radius: var(--border-radius);
        overflow: hidden;
        box-shadow: 0 8px 30px rgba(0,0,0,0.3);
    }

    .calendar-day {
        background: linear-gradient(135deg, var(--dark-gray) 0%, #333 100%);
        min-height: 80px;
        padding: 8px 4px;
        border: 1px solid rgba(255,255,255,0.1);
        position: relative;
        cursor: pointer;
        transition: var(--transition);
    }

    .calendar-day:hover {
        background: linear-gradient(135deg, rgba(233, 30, 99, 0.2) 0%, rgba(156, 39, 176, 0.1) 100%);
        transform: scale(1.05);
        z-index: 2;
    }

    .calendar-day.header {
        background: linear-gradient(135deg, var(--dark) 0%, #222 100%);
        font-weight: bold;
        text-align: center;
        padding: 15px 8px;
        color: var(--primary);
        cursor: default;
        font-size: 0.9em;
        min-height: 50px;
    }

    .calendar-day.header:hover {
        background: linear-gradient(135deg, var(--dark) 0%, #222 100%);
        transform: none;
    }

    .calendar-day.today {
        background: linear-gradient(135deg, rgba(233, 30, 99, 0.3) 0%, rgba(156, 39, 176, 0.2) 100%);
        border: 3px solid var(--primary);
        box-shadow: 0 0 30px rgba(233, 30, 99, 0.3);
    }

    .calendar-day.has-event::after {
        content: '';
        position: absolute;
        top: 6px;
        right: 6px;
        width: 6px;
        height: 6px;
        background: var(--secondary);
        border-radius: 50%;
        box-shadow: 0 0 10px var(--secondary);
    }

    .day-number {
        font-weight: bold;
        margin-bottom: 4px;
        color: var(--primary);
        font-size: 1em;
        text-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }

    .event {
        background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        color: var(--darker);
        padding: 4px 6px;
        margin: 2px 0;
        border-radius: 4px;
        font-size: 0.7em;
        cursor: pointer;
        transition: var(--transition);
        font-weight: 600;
        box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }

    .event:hover {
        transform: scale(1.05);
        box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }

    /* Modals */
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.95);
        z-index: 1000;
        backdrop-filter: blur(15px);
        animation: fadeIn 0.4s ease;
        padding: 10px;
    }

    .modal-content {
        background: linear-gradient(135deg, var(--dark-gray) 0%, #2d2d2d 100%);
        padding: 30px;
        border-radius: var(--border-radius);
        max-width: 95%;
        width: 600px;
        max-height: 90vh;
        overflow-y: auto;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 2px solid var(--primary);
        box-shadow: var(--shadow);
        animation: modalSlideIn 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    @keyframes modalSlideIn {
        from {
            opacity: 0;
            transform: translate(-50%, -60%) scale(0.9);
        }
        to {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }
    }

    /* Empty States */
    .empty-state {
        text-align: center;
        padding: 60px 30px;
        color: rgba(255,255,255,0.6);
    }

    .empty-state i {
        font-size: 4em;
        margin-bottom: 20px;
        opacity: 0.4;
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        filter: drop-shadow(0 4px 15px rgba(0,0,0,0.3));
    }

    .empty-state h3 {
        font-size: 1.6em;
        margin-bottom: 12px;
        color: rgba(255,255,255,0.8);
        font-weight: 600;
    }

    .empty-state p {
        font-size: 1em;
        margin-bottom: 25px;
        opacity: 0.8;
        line-height: 1.6;
    }

    /* Toast Notifications */
    .toast {
        position: fixed;
        bottom: 30px;
        left: 50%;
        transform: translateX(-50%);
        background: linear-gradient(135deg, var(--success) 0%, #66bb6a 100%);
        color: white;
        padding: 16px 24px;
        border-radius: var(--border-radius);
        z-index: 1001;
        display: none;
        box-shadow: var(--shadow);
        animation: toastSlideUp 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        font-weight: 600;
        backdrop-filter: blur(10px);
        max-width: 90%;
        text-align: center;
    }

    .toast.show {
        display: block;
    }

    @keyframes toastSlideUp {
        from {
            bottom: -60px;
            opacity: 0;
        }
        to {
            bottom: 30px;
            opacity: 1;
        }
    }

    /* Today's Appointments Special Styling */
    .todays-appointment-item {
        background: linear-gradient(135deg, rgba(233, 30, 99, 0.15) 0%, rgba(156, 39, 176, 0.1) 100%);
        border-left: 4px solid var(--primary);
        padding: 18px;
        margin-bottom: 12px;
        border-radius: 12px;
        transition: var(--transition);
        cursor: pointer;
    }

    .todays-appointment-item:hover {
        transform: translateX(10px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.3);
    }

    .todays-appointment-item.urgent {
        border-left-color: var(--warning);
        background: linear-gradient(135deg, rgba(255,152,0,0.15) 0%, rgba(156, 39, 176, 0.1) 100%);
    }

    .todays-appointment-item.completed {
        border-left-color: var(--success);
        background: linear-gradient(135deg, rgba(76,175,80,0.15) 0%, rgba(233, 30, 99, 0.1) 100%);
        opacity: 0.8;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        #sidebar {
            width: 70px;
        }

        .logo, .nav-link span, .nav-section-title {
            display: none;
        }

        .nav-link {
            justify-content: center;
            padding: 1rem;
        }

        .nav-link i {
            margin-right: 0;
        }

        .app-container {
            max-width: calc(100% - 70px);
            padding: 15px;
        }
        
        .stats-grid {
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .calendar-grid {
            grid-template-columns: repeat(7, 1fr);
        }
        
        .client-item, .appointment-item, .inventory-item {
            flex-direction: column;
            gap: 15px;
        }
        
        .item-actions {
            opacity: 1;
            width: 100%;
            justify-content: flex-end;
        }
        
        .modal-content {
            width: 95%;
            padding: 25px 20px;
        }
        
        .install-prompt {
            flex-direction: column;
            text-align: center;
            padding: 20px;
        }

        .app-header {
            padding: 20px 15px;
        }

        .card {
            padding: 20px;
        }

        .products-grid {
            grid-template-columns: 1fr;
            gap: 15px;
        }
    }

    @media (max-width: 480px) {
        .stats-grid {
            grid-template-columns: 1fr;
        }
        
        .card {
            padding: 18px 15px;
        }

        .calendar-day {
            min-height: 60px;
            padding: 6px 3px;
        }

        .day-number {
            font-size: 0.9em;
        }

        .event {
            font-size: 0.6em;
            padding: 3px 4px;
        }

        .form-control {
            padding: 14px;
        }
    }

    /* Loading Animation */
    .loading {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid rgba(255,255,255,.3);
        border-radius: 50%;
        border-top-color: var(--primary);
        animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
        to { transform: rotate(360deg); }
    }
</style>
</head>
<body>
    <!-- Sidebar Navigation -->
    <nav id="sidebar">
        <div class="logo">HairSalon Pro</div>
        
        <div class="nav-section">
            <div class="nav-section-title" data-i18n="main_navigation">Main Navigation</div>
            <a class="nav-link active" data-section="dashboard">
                <i class="fas fa-tachometer-alt"></i> <span data-i18n="dashboard">Dashboard</span>
            </a>
            <a class="nav-link" data-section="clients">
                <i class="fas fa-users"></i> <span data-i18n="clients">Clients</span>
            </a>
            <a class="nav-link" data-section="appointments">
                <i class="fas fa-calendar-check"></i> <span data-i18n="appointments">Appointments</span>
            </a>
            <a class="nav-link" data-section="inventory">
                <i class="fas fa-boxes"></i> <span data-i18n="inventory">Inventory</span>
            </a>
            <a class="nav-link" data-section="calendar">
                <i class="fas fa-calendar-day"></i> <span data-i18n="calendar">Calendar</span>
            </a>
            <a class="nav-link" data-section="reports">
                <i class="fas fa-chart-bar"></i> <span data-i18n="reports">Reports</span>
            </a>
        </div>

        <div class="nav-section">
            <div class="nav-section-title" data-i18n="quick_actions">Quick Actions</div>
            <a class="nav-link" id="quickAddClient">
                <i class="fas fa-user-plus"></i> <span data-i18n="add_client">Add Client</span>
            </a>
            <a class="nav-link" id="quickAddAppointment">
                <i class="fas fa-calendar-plus"></i> <span data-i18n="schedule_appointment">Schedule Appointment</span>
            </a>
            <a class="nav-link" id="quickAddInventory">
                <i class="fas fa-box-open"></i> <span data-i18n="add_inventory">Add Inventory</span>
            </a>
        </div>

        <div class="language-selector">
            <select id="languageSelect">
                <option value="en">English</option>
                <option value="es">Español</option>
                <option value="ru">Русский</option>
                <option value="he">עברית</option>
            </select>
        </div>
    </nav>

    <!-- Main Content Area -->
    <div class="app-container">
        <!-- Professional Header -->
        <div class="app-header">
            <div class="logo">
                <i class="fas fa-scissors"></i>
                HairSalon Pro
            </div>
            <div class="tagline" data-i18n="tagline">Professional Hairdresser Management System</div>
            <button class="install-btn" id="installButton">
                <i class="fas fa-download"></i> <span data-i18n="install_app">Install App</span>
            </button>
        </div>

        <!-- Dashboard Section -->
        <section id="dashboard" class="section active">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title" onclick="app.showSection('dashboard')">
                        <i class="fas fa-tachometer-alt"></i> <span data-i18n="salon_overview">Salon Overview</span>
                    </h2>
                    <button class="btn btn-outline" onclick="app.exportData('all')">
                        <i class="fas fa-download"></i> <span data-i18n="backup_data">Backup Data</span>
                    </button>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card" onclick="app.showSection('clients')">
                        <div class="stat-value" id="totalClients">0</div>
                        <div class="stat-label" data-i18n="total_clients">Total Clients</div>
                    </div>
                    <div class="stat-card" onclick="app.showSection('appointments')">
                        <div class="stat-value" id="todayAppointments">0</div>
                        <div class="stat-label" data-i18n="today_appointments">Today's Appointments</div>
                    </div>
                    <div class="stat-card" onclick="app.showSection('inventory')">
                        <div class="stat-value" id="lowStockItems">0</div>
                        <div class="stat-label" data-i18n="low_stock">Low Stock Items</div>
                    </div>
                    <div class="stat-card" onclick="app.showSection('reports')">
                        <div class="stat-value" id="monthlyRevenue">$0</div>
                        <div class="stat-label" data-i18n="monthly_revenue">Monthly Revenue</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="fas fa-clock"></i> <span data-i18n="todays_appointments">Today's Appointments</span>
                    </h2>
                    <button class="btn btn-primary" onclick="app.showSection('appointments')">
                        <i class="fas fa-eye"></i> <span data-i18n="view_all">View All</span>
                    </button>
                </div>
                <div id="todaysAppointmentsList">
                    <!-- Today's appointments will be populated here -->
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="fas fa-chart-line"></i> <span data-i18n="recent_activity">Recent Activity</span>
                    </h2>
                </div>
                <div id="recentActivity">
                    <!-- Recent activity will be populated here -->
                </div>
            </div>
        </section>

        <!-- Clients Section -->
        <section id="clients" class="section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title" onclick="app.showSection('clients')">
                        <i class="fas fa-users"></i> <span data-i18n="client_management">Client Management</span>
                    </h2>
                    <button class="btn btn-primary" onclick="app.openModal('addClientModal')">
                        <i class="fas fa-user-plus"></i> <span data-i18n="add_client">Add Client</span>
                    </button>
                </div>
                
                <div class="form-group">
                    <input type="text" class="form-control" id="clientSearch" placeholder="Search clients..." data-i18n-placeholder="search_clients">
                </div>
                
                <div id="clientsList">
                    <!-- Clients will be populated here -->
                </div>
            </div>
        </section>

        <!-- Appointments Section -->
        <section id="appointments" class="section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title" onclick="app.showSection('appointments')">
                        <i class="fas fa-calendar-check"></i> <span data-i18n="appointment_scheduling">Appointment Scheduling</span>
                    </h2>
                    <button class="btn btn-primary" onclick="app.openModal('addAppointmentModal')">
                        <i class="fas fa-calendar-plus"></i> <span data-i18n="schedule_appointment">Schedule Appointment</span>
                    </button>
                </div>
                
                <div class="form-group">
                    <input type="text" class="form-control" id="appointmentSearch" placeholder="Search appointments..." data-i18n-placeholder="search_appointments">
                </div>
                
                <div id="appointmentsList">
                    <!-- Appointments will be populated here -->
                </div>
            </div>
        </section>

        <!-- Inventory Section -->
        <section id="inventory" class="section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title" onclick="app.showSection('inventory')">
                        <i class="fas fa-boxes"></i> <span data-i18n="inventory_management">Inventory Management</span>
                    </h2>
                    <button class="btn btn-primary" onclick="app.openModal('addInventoryModal')">
                        <i class="fas fa-box-open"></i> <span data-i18n="add_inventory">Add Inventory</span>
                    </button>
                </div>
                
                <div class="form-group">
                    <input type="text" class="form-control" id="inventorySearch" placeholder="Search inventory..." data-i18n-placeholder="search_inventory">
                </div>
                
                <div id="inventoryList">
                    <!-- Inventory items will be populated here -->
                </div>
            </div>
        </section>

        <!-- Calendar Section -->
        <section id="calendar" class="section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title" onclick="app.showSection('calendar')">
                        <i class="fas fa-calendar-day"></i> <span data-i18n="appointment_calendar">Appointment Calendar</span>
                    </h2>
                    <div class="calendar-controls">
                        <button class="btn btn-outline" onclick="app.prevMonth()">
                            <i class="fas fa-chevron-left"></i> <span data-i18n="prev_month">Prev Month</span>
                        </button>
                        <h3 id="currentMonth">Month Year</h3>
                        <button class="btn btn-outline" onclick="app.nextMonth()">
                            <span data-i18n="next_month">Next Month</span> <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
                
                <div class="calendar-grid" id="calendarGrid">
                    <!-- Calendar will be populated here -->
                </div>
            </div>
        </section>

        <!-- Reports Section -->
        <section id="reports" class="section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title" onclick="app.showSection('reports')">
                        <i class="fas fa-chart-bar"></i> <span data-i18n="salon_reports">Salon Reports</span>
                    </h2>
                    <button class="btn btn-primary" onclick="app.generateReport()">
                        <i class="fas fa-file-export"></i> <span data-i18n="export_report">Export Report</span>
                    </button>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="reportTotalClients">0</div>
                        <div class="stat-label" data-i18n="total_clients">Total Clients</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="reportMonthlyAppointments">0</div>
                        <div class="stat-label" data-i18n="monthly_appointments">Monthly Appointments</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="reportRevenue">$0</div>
                        <div class="stat-label" data-i18n="total_revenue">Total Revenue</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="reportPopularService">-</div>
                        <div class="stat-label" data-i18n="popular_service">Popular Service</div>
                    </div>
                </div>
                
                <div class="card">
                    <h3 class="card-title">
                        <i class="fas fa-chart-pie"></i> <span data-i18n="service_distribution">Service Distribution</span>
                    </h3>
                    <div id="serviceChart">
                        <!-- Service chart will be populated here -->
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Modals -->
    <!-- Add Client Modal -->
    <div id="addClientModal" class="modal">
        <div class="modal-content">
            <h2 class="card-title">
                <i class="fas fa-user-plus"></i> <span data-i18n="add_client">Add Client</span>
            </h2>
            <form id="addClientForm">
                <div class="form-group">
                    <label class="form-label" for="clientName" data-i18n="client_name">Client Name</label>
                    <input type="text" class="form-control" id="clientName" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="clientPhone" data-i18n="phone_number">Phone Number</label>
                    <input type="tel" class="form-control" id="clientPhone">
                </div>
                <div class="form-group">
                    <label class="form-label" for="clientEmail" data-i18n="email">Email</label>
                    <input type="email" class="form-control" id="clientEmail">
                </div>
                <div class="form-group">
                    <label class="form-label" for="clientNotes" data-i18n="notes">Notes</label>
                    <textarea class="form-control" id="clientNotes" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> <span data-i18n="save_client">Save Client</span>
                    </button>
                    <button type="button" class="btn btn-outline" onclick="app.closeModal('addClientModal')">
                        <i class="fas fa-times"></i> <span data-i18n="cancel">Cancel</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Appointment Modal -->
    <div id="addAppointmentModal" class="modal">
        <div class="modal-content">
            <h2 class="card-title">
                <i class="fas fa-calendar-plus"></i> <span data-i18n="schedule_appointment">Schedule Appointment</span>
            </h2>
            <form id="addAppointmentForm">
                <div class="form-group">
                    <label class="form-label" for="appointmentClient" data-i18n="select_client">Select Client</label>
                    <select class="form-control" id="appointmentClient" required>
                        <option value="" data-i18n="select_client">Select Client</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="appointmentDate" data-i18n="date">Date</label>
                    <input type="date" class="form-control" id="appointmentDate" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="appointmentTime" data-i18n="time">Time</label>
                    <input type="time" class="form-control" id="appointmentTime" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="appointmentService" data-i18n="service">Service</label>
                    <select class="form-control" id="appointmentService" required>
                        <option value="" data-i18n="select_service">Select Service</option>
                        <option value="haircut" data-i18n="haircut">Haircut</option>
                        <option value="coloring" data-i18n="coloring">Coloring</option>
                        <option value="styling" data-i18n="styling">Styling</option>
                        <option value="treatment" data-i18n="treatment">Treatment</option>
                        <option value="extension" data-i18n="extension">Extension</option>
                        <option value="other" data-i18n="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="appointmentDuration" data-i18n="duration">Duration (minutes)</label>
                    <input type="number" class="form-control" id="appointmentDuration" min="15" step="15" value="60" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="appointmentPrice" data-i18n="price">Price ($)</label>
                    <input type="number" class="form-control" id="appointmentPrice" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="appointmentNotes" data-i18n="notes">Notes</label>
                    <textarea class="form-control" id="appointmentNotes" rows="3"></textarea>
                </div>
                <div class="products-section">
                    <h3 class="form-label" data-i18n="products_used">Products Used</h3>
                    <div class="products-grid">
                        <select class="form-control" id="productSelect">
                            <option value="" data-i18n="select_product">Select Product</option>
                        </select>
                        <input type="number" class="form-control product-qty" id="productQty" min="1" value="1" placeholder="Qty">
                        <button type="button" class="btn btn-outline" onclick="app.addProductToAppointment()">
                            <i class="fas fa-plus"></i> <span data-i18n="add">Add</span>
                        </button>
                    </div>
                    <div id="appointmentProductsList">
                        <!-- Products will be added here -->
                    </div>
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> <span data-i18n="save_appointment">Save Appointment</span>
                    </button>
                    <button type="button" class="btn btn-outline" onclick="app.closeModal('addAppointmentModal')">
                        <i class="fas fa-times"></i> <span data-i18n="cancel">Cancel</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Inventory Modal -->
    <div id="addInventoryModal" class="modal">
        <div class="modal-content">
            <h2 class="card-title">
                <i class="fas fa-box-open"></i> <span data-i18n="add_inventory">Add Inventory</span>
            </h2>
            <form id="addInventoryForm">
                <div class="form-group">
                    <label class="form-label" for="inventoryName" data-i18n="product_name">Product Name</label>
                    <input type="text" class="form-control" id="inventoryName" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="inventoryCategory" data-i18n="category">Category</label>
                    <select class="form-control" id="inventoryCategory" required>
                        <option value="" data-i18n="select_category">Select Category</option>
                        <option value="shampoo" data-i18n="shampoo">Shampoo</option>
                        <option value="conditioner" data-i18n="conditioner">Conditioner</option>
                        <option value="color" data-i18n="color">Color</option>
                        <option value="treatment" data-i18n="treatment">Treatment</option>
                        <option value="styling" data-i18n="styling">Styling</option>
                        <option value="tools" data-i18n="tools">Tools</option>
                        <option value="other" data-i18n="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="inventoryQuantity" data-i18n="quantity">Quantity</label>
                    <input type="number" class="form-control" id="inventoryQuantity" min="0" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="inventoryMinStock" data-i18n="min_stock">Minimum Stock</label>
                    <input type="number" class="form-control" id="inventoryMinStock" min="1" value="5">
                </div>
                <div class="form-group">
                    <label class="form-label" for="inventoryCost" data-i18n="cost_per_unit">Cost per Unit ($)</label>
                    <input type="number" class="form-control" id="inventoryCost" min="0" step="0.01">
                </div>
                <div class="form-group">
                    <label class="form-label" for="inventorySupplier" data-i18n="supplier">Supplier</label>
                    <input type="text" class="form-control" id="inventorySupplier">
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> <span data-i18n="save_inventory">Save Inventory</span>
                    </button>
                    <button type="button" class="btn btn-outline" onclick="app.closeModal('addInventoryModal')">
                        <i class="fas fa-times"></i> <span data-i18n="cancel">Cancel</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Install Prompt -->
    <div class="install-prompt" id="installPrompt">
        <div data-i18n="install_prompt">Install HairSalon Pro for easy access</div>
        <button class="btn btn-primary" id="installPromptButton">
            <i class="fas fa-download"></i> <span data-i18n="install">Install</span>
        </button>
        <button class="btn btn-outline" id="installDismissButton">
            <i class="fas fa-times"></i> <span data-i18n="dismiss">Dismiss</span>
        </button>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <script>
        // Application object
        const app = {
            // Initialize the application
            init() {
                console.log('Initializing HairSalon Pro...');
                
                // Load data from localStorage
                this.loadData();
                
                // Set up event listeners
                this.setupEventListeners();
                
                // Set up service worker for PWA
                this.setupServiceWorker();
                
                // Initialize the UI
                this.updateDashboard();
                this.renderClients();
                this.renderAppointments();
                this.renderInventory();
                this.renderCalendar();
                this.updateReports();
                
                // Set up language
                this.setupLanguage();
                
                console.log('HairSalon Pro initialized successfully!');
            },
            
            // Data management
            data: {
                clients: [],
                appointments: [],
                inventory: [],
                settings: {
                    language: 'en'
                }
            },
            
            // Load data from localStorage
            loadData() {
                const savedData = localStorage.getItem('hairsalon-pro-data');
                if (savedData) {
                    this.data = JSON.parse(savedData);
                } else {
                    // Initialize with sample data
                    this.initializeSampleData();
                }
            },
            
            // Save data to localStorage
            saveData() {
                localStorage.setItem('hairsalon-pro-data', JSON.stringify(this.data));
            },
            
            // Initialize with sample data
            initializeSampleData() {
                this.data.clients = [
                    {
                        id: 1,
                        name: 'Sarah Johnson',
                        phone: '+1 (555) 123-4567',
                        email: 'sarah.johnson@example.com',
                        notes: 'Prefers organic products',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 2,
                        name: 'Michael Chen',
                        phone: '+1 (555) 987-6543',
                        email: 'michael.chen@example.com',
                        notes: 'Allergic to certain hair dyes',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 3,
                        name: 'Emma Rodriguez',
                        phone: '+1 (555) 456-7890',
                        email: 'emma.rodriguez@example.com',
                        notes: 'Regular client, comes every 4 weeks',
                        createdAt: new Date().toISOString()
                    }
                ];
                
                this.data.appointments = [
                    {
                        id: 1,
                        clientId: 1,
                        date: new Date().toISOString().split('T')[0],
                        time: '10:00',
                        service: 'coloring',
                        duration: 90,
                        price: 85.00,
                        notes: 'Full color with highlights',
                        status: 'scheduled',
                        productsUsed: [
                            { productId: 1, quantity: 1 },
                            { productId: 3, quantity: 2 }
                        ],
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 2,
                        clientId: 2,
                        date: new Date().toISOString().split('T')[0],
                        time: '14:30',
                        service: 'haircut',
                        duration: 45,
                        price: 35.00,
                        notes: 'Regular trim',
                        status: 'scheduled',
                        productsUsed: [],
                        createdAt: new Date().toISOString()
                    }
                ];
                
                this.data.inventory = [
                    {
                        id: 1,
                        name: 'Professional Color Kit',
                        category: 'color',
                        quantity: 12,
                        minStock: 5,
                        cost: 8.50,
                        supplier: 'Beauty Supplies Inc.',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 2,
                        name: 'Moisturizing Shampoo',
                        category: 'shampoo',
                        quantity: 8,
                        minStock: 10,
                        cost: 12.00,
                        supplier: 'HairCare Pro',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 3,
                        name: 'Repair Conditioner',
                        category: 'conditioner',
                        quantity: 6,
                        minStock: 8,
                        cost: 14.50,
                        supplier: 'HairCare Pro',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 4,
                        name: 'Heat Protectant Spray',
                        category: 'styling',
                        quantity: 15,
                        minStock: 5,
                        cost: 9.75,
                        supplier: 'Style Masters',
                        createdAt: new Date().toISOString()
                    }
                ];
                
                this.saveData();
            },
            
            // Set up event listeners
            setupEventListeners() {
                // Navigation
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const section = link.getAttribute('data-section');
                        if (section) {
                            this.showSection(section);
                        }
                    });
                });
                
                // Quick actions
                document.getElementById('quickAddClient').addEventListener('click', () => {
                    this.openModal('addClientModal');
                });
                
                document.getElementById('quickAddAppointment').addEventListener('click', () => {
                    this.openModal('addAppointmentModal');
                });
                
                document.getElementById('quickAddInventory').addEventListener('click', () => {
                    this.openModal('addInventoryModal');
                });
                
                // Forms
                document.getElementById('addClientForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.addClient();
                });
                
                document.getElementById('addAppointmentForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.addAppointment();
                });
                
                document.getElementById('addInventoryForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.addInventory();
                });
                
                // Search functionality
                document.getElementById('clientSearch').addEventListener('input', (e) => {
                    this.filterClients(e.target.value);
                });
                
                document.getElementById('appointmentSearch').addEventListener('input', (e) => {
                    this.filterAppointments(e.target.value);
                });
                
                document.getElementById('inventorySearch').addEventListener('input', (e) => {
                    this.filterInventory(e.target.value);
                });
                
                // Language selector
                document.getElementById('languageSelect').addEventListener('change', (e) => {
                    this.changeLanguage(e.target.value);
                });
                
                // PWA install
                this.setupPWA();
            },
            
            // Set up service worker for PWA
            setupServiceWorker() {
                if ('serviceWorker' in navigator) {
                    window.addEventListener('load', () => {
                        navigator.serviceWorker.register('/sw.js')
                            .then((registration) => {
                                console.log('SW registered: ', registration);
                            })
                            .catch((registrationError) => {
                                console.log('SW registration failed: ', registrationError);
                            });
                    });
                }
            },
            
            // Set up PWA install prompt
            setupPWA() {
                let deferredPrompt;
                const installButton = document.getElementById('installButton');
                const installPrompt = document.getElementById('installPrompt');
                const installPromptButton = document.getElementById('installPromptButton');
                const installDismissButton = document.getElementById('installDismissButton');
                
                window.addEventListener('beforeinstallprompt', (e) => {
                    // Prevent the mini-infobar from appearing on mobile
                    e.preventDefault();
                    // Stash the event so it can be triggered later
                    deferredPrompt = e;
                    // Show the install button
                    installButton.style.display = 'inline-flex';
                    installButton.classList.add('pulse');
                    
                    // Show the install prompt after a delay
                    setTimeout(() => {
                        installPrompt.classList.add('show');
                    }, 3000);
                });
                
                installButton.addEventListener('click', () => {
                    if (deferredPrompt) {
                        // Show the install prompt
                        deferredPrompt.prompt();
                        // Wait for the user to respond to the prompt
                        deferredPrompt.userChoice.then((choiceResult) => {
                            if (choiceResult.outcome === 'accepted') {
                                console.log('User accepted the install prompt');
                                installButton.style.display = 'none';
                                installPrompt.classList.remove('show');
                            } else {
                                console.log('User dismissed the install prompt');
                            }
                            deferredPrompt = null;
                        });
                    }
                });
                
                installPromptButton.addEventListener('click', () => {
                    if (deferredPrompt) {
                        deferredPrompt.prompt();
                        deferredPrompt.userChoice.then((choiceResult) => {
                            if (choiceResult.outcome === 'accepted') {
                                console.log('User accepted the install prompt');
                                installPrompt.classList.remove('show');
                            }
                            deferredPrompt = null;
                        });
                    }
                });
                
                installDismissButton.addEventListener('click', () => {
                    installPrompt.classList.remove('show');
                });
                
                window.addEventListener('appinstalled', () => {
                    console.log('PWA was installed');
                    installButton.style.display = 'none';
                    installPrompt.classList.remove('show');
                    deferredPrompt = null;
                });
            },
            
            // Show a specific section
            showSection(sectionId) {
                // Hide all sections
                document.querySelectorAll('.section').forEach(section => {
                    section.classList.remove('active');
                });
                
                // Show the selected section
                document.getElementById(sectionId).classList.add('active');
                
                // Update active nav link
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('active');
                });
                
                document.querySelector(`[data-section="${sectionId}"]`).classList.add('active');
                
                // Update section-specific content
                if (sectionId === 'dashboard') {
                    this.updateDashboard();
                } else if (sectionId === 'clients') {
                    this.renderClients();
                } else if (sectionId === 'appointments') {
                    this.renderAppointments();
                } else if (sectionId === 'inventory') {
                    this.renderInventory();
                } else if (sectionId === 'calendar') {
                    this.renderCalendar();
                } else if (sectionId === 'reports') {
                    this.updateReports();
                }
            },
            
            // Open a modal
            openModal(modalId) {
                document.getElementById(modalId).style.display = 'block';
                
                // Populate dropdowns if needed
                if (modalId === 'addAppointmentModal') {
                    this.populateClientDropdown();
                    this.populateProductDropdown();
                } else if (modalId === 'addInventoryModal') {
                    // Set today's date as default for appointment date
                    document.getElementById('appointmentDate').valueAsDate = new Date();
                }
            },
            
            // Close a modal
            closeModal(modalId) {
                document.getElementById(modalId).style.display = 'none';
                
                // Reset forms
                document.querySelector(`#${modalId} form`).reset();
                
                // Clear dynamic content
                if (modalId === 'addAppointmentModal') {
                    document.getElementById('appointmentProductsList').innerHTML = '';
                }
            },
            
            // Populate client dropdown for appointments
            populateClientDropdown() {
                const dropdown = document.getElementById('appointmentClient');
                dropdown.innerHTML = '<option value="" data-i18n="select_client">Select Client</option>';
                
                this.data.clients.forEach(client => {
                    const option = document.createElement('option');
                    option.value = client.id;
                    option.textContent = client.name;
                    dropdown.appendChild(option);
                });
            },
            
            // Populate product dropdown for appointments
            populateProductDropdown() {
                const dropdown = document.getElementById('productSelect');
                dropdown.innerHTML = '<option value="" data-i18n="select_product">Select Product</option>';
                
                this.data.inventory.forEach(product => {
                    const option = document.createElement('option');
                    option.value = product.id;
                    option.textContent = `${product.name} (${product.quantity} in stock)`;
                    dropdown.appendChild(option);
                });
            },
            
            // Add a product to the appointment
            addProductToAppointment() {
                const productSelect = document.getElementById('productSelect');
                const productQty = document.getElementById('productQty');
                
                if (!productSelect.value || !productQty.value) {
                    this.showToast('Please select a product and quantity', 'warning');
                    return;
                }
                
                const productId = parseInt(productSelect.value);
                const quantity = parseInt(productQty.value);
                const product = this.data.inventory.find(p => p.id === productId);
                
                if (!product) {
                    this.showToast('Product not found', 'error');
                    return;
                }
                
                if (quantity > product.quantity) {
                    this.showToast(`Only ${product.quantity} units available`, 'error');
                    return;
                }
                
                const productsList = document.getElementById('appointmentProductsList');
                const productItem = document.createElement('div');
                productItem.className = 'product-item';
                productItem.innerHTML = `
                    <div>${product.name}</div>
                    <div>${quantity}</div>
                    <button type="button" class="remove-product" onclick="this.parentElement.remove()">
                        <i class="fas fa-trash"></i>
                    </button>
                    <input type="hidden" name="productId" value="${productId}">
                    <input type="hidden" name="productQty" value="${quantity}">
                `;
                
                productsList.appendChild(productItem);
                
                // Reset inputs
                productSelect.value = '';
                productQty.value = '1';
            },
            
            // Add a new client
            addClient() {
                const name = document.getElementById('clientName').value;
                const phone = document.getElementById('clientPhone').value;
                const email = document.getElementById('clientEmail').value;
                const notes = document.getElementById('clientNotes').value;
                
                const newClient = {
                    id: this.generateId(),
                    name,
                    phone,
                    email,
                    notes,
                    createdAt: new Date().toISOString()
                };
                
                this.data.clients.push(newClient);
                this.saveData();
                this.renderClients();
                this.updateDashboard();
                this.closeModal('addClientModal');
                
                this.showToast('Client added successfully', 'success');
            },
            
            // Add a new appointment
            addAppointment() {
                const clientId = parseInt(document.getElementById('appointmentClient').value);
                const date = document.getElementById('appointmentDate').value;
                const time = document.getElementById('appointmentTime').value;
                const service = document.getElementById('appointmentService').value;
                const duration = parseInt(document.getElementById('appointmentDuration').value);
                const price = parseFloat(document.getElementById('appointmentPrice').value);
                const notes = document.getElementById('appointmentNotes').value;
                
                // Get products used
                const productItems = document.getElementById('appointmentProductsList').querySelectorAll('.product-item');
                const productsUsed = [];
                
                productItems.forEach(item => {
                    const productId = parseInt(item.querySelector('input[name="productId"]').value);
                    const quantity = parseInt(item.querySelector('input[name="productQty"]').value);
                    productsUsed.push({ productId, quantity });
                    
                    // Update inventory
                    const product = this.data.inventory.find(p => p.id === productId);
                    if (product) {
                        product.quantity -= quantity;
                    }
                });
                
                const newAppointment = {
                    id: this.generateId(),
                    clientId,
                    date,
                    time,
                    service,
                    duration,
                    price,
                    notes,
                    status: 'scheduled',
                    productsUsed,
                    createdAt: new Date().toISOString()
                };
                
                this.data.appointments.push(newAppointment);
                this.saveData();
                this.renderAppointments();
                this.updateDashboard();
                this.renderCalendar();
                this.closeModal('addAppointmentModal');
                
                this.showToast('Appointment scheduled successfully', 'success');
            },
            
            // Add a new inventory item
            addInventory() {
                const name = document.getElementById('inventoryName').value;
                const category = document.getElementById('inventoryCategory').value;
                const quantity = parseInt(document.getElementById('inventoryQuantity').value);
                const minStock = parseInt(document.getElementById('inventoryMinStock').value);
                const cost = parseFloat(document.getElementById('inventoryCost').value) || 0;
                const supplier = document.getElementById('inventorySupplier').value;
                
                const newInventory = {
                    id: this.generateId(),
                    name,
                    category,
                    quantity,
                    minStock,
                    cost,
                    supplier,
                    createdAt: new Date().toISOString()
                };
                
                this.data.inventory.push(newInventory);
                this.saveData();
                this.renderInventory();
                this.updateDashboard();
                this.closeModal('addInventoryModal');
                
                this.showToast('Inventory item added successfully', 'success');
            },
            
            // Update dashboard with current stats
            updateDashboard() {
                // Update stats
                document.getElementById('totalClients').textContent = this.data.clients.length;
                
                const today = new Date().toISOString().split('T')[0];
                const todayAppointments = this.data.appointments.filter(a => a.date === today);
                document.getElementById('todayAppointments').textContent = todayAppointments.length;
                
                const lowStockItems = this.data.inventory.filter(i => i.quantity <= i.minStock);
                document.getElementById('lowStockItems').textContent = lowStockItems.length;
                
                const currentMonth = new Date().getMonth();
                const currentYear = new Date().getFullYear();
                const monthlyRevenue = this.data.appointments
                    .filter(a => {
                        const appointmentDate = new Date(a.date);
                        return appointmentDate.getMonth() === currentMonth && 
                               appointmentDate.getFullYear() === currentYear;
                    })
                    .reduce((total, a) => total + a.price, 0);
                document.getElementById('monthlyRevenue').textContent = `$${monthlyRevenue.toFixed(2)}`;
                
                // Update today's appointments
                this.renderTodaysAppointments();
                
                // Update recent activity
                this.renderRecentActivity();
            },
            
            // Render today's appointments
            renderTodaysAppointments() {
                const container = document.getElementById('todaysAppointmentsList');
                const today = new Date().toISOString().split('T')[0];
                const todayAppointments = this.data.appointments
                    .filter(a => a.date === today)
                    .sort((a, b) => a.time.localeCompare(b.time));
                
                if (todayAppointments.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-calendar-times"></i>
                            <h3 data-i18n="no_appointments_today">No appointments today</h3>
                            <p data-i18n="no_appointments_today_desc">You're all caught up! Enjoy your day or schedule new appointments.</p>
                            <button class="btn btn-primary" onclick="app.openModal('addAppointmentModal')">
                                <i class="fas fa-calendar-plus"></i> <span data-i18n="schedule_appointment">Schedule Appointment</span>
                            </button>
                        </div>
                    `;
                    return;
                }
                
                let html = '';
                todayAppointments.forEach(appointment => {
                    const client = this.data.clients.find(c => c.id === appointment.clientId);
                    if (!client) return;
                    
                    const now = new Date();
                    const appointmentTime = new Date(`${appointment.date}T${appointment.time}`);
                    const timeDiff = appointmentTime - now;
                    const hoursDiff = timeDiff / (1000 * 60 * 60);
                    
                    let statusClass = '';
                    if (appointment.status === 'completed') {
                        statusClass = 'completed';
                    } else if (hoursDiff < 1 && hoursDiff > 0) {
                        statusClass = 'urgent';
                    }
                    
                    html += `
                        <div class="todays-appointment-item ${statusClass}">
                            <div class="item-title">
                                <i class="fas fa-user"></i> ${client.name}
                                <span class="item-meta">${appointment.time} - ${this.getServiceName(appointment.service)}</span>
                            </div>
                            <div class="item-meta">
                                ${appointment.notes || 'No additional notes'}
                                <div><strong>$${appointment.price.toFixed(2)}</strong> | ${appointment.duration} min</div>
                            </div>
                            <div class="item-actions">
                                <button class="action-btn btn-success" onclick="app.completeAppointment(${appointment.id})">
                                    <i class="fas fa-check"></i>
                                </button>
                                <button class="action-btn btn-warning" onclick="app.editAppointment(${appointment.id})">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="action-btn btn-danger" onclick="app.cancelAppointment(${appointment.id})">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
                this.applyTranslations();
            },
            
            // Render recent activity
            renderRecentActivity() {
                const container = document.getElementById('recentActivity');
                
                // Combine clients, appointments, and inventory, sort by creation date
                const allActivities = [
                    ...this.data.clients.map(c => ({ type: 'client', item: c, date: c.createdAt })),
                    ...this.data.appointments.map(a => ({ type: 'appointment', item: a, date: a.createdAt })),
                    ...this.data.inventory.map(i => ({ type: 'inventory', item: i, date: i.createdAt }))
                ].sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 5);
                
                if (allActivities.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-history"></i>
                            <h3 data-i18n="no_recent_activity">No recent activity</h3>
                            <p data-i18n="no_recent_activity_desc">Activities will appear here as you use the app.</p>
                        </div>
                    `;
                    return;
                }
                
                let html = '';
                allActivities.forEach(activity => {
                    let icon, text;
                    
                    if (activity.type === 'client') {
                        icon = 'fas fa-user-plus';
                        text = `New client added: ${activity.item.name}`;
                    } else if (activity.type === 'appointment') {
                        const client = this.data.clients.find(c => c.id === activity.item.clientId);
                        icon = 'fas fa-calendar-plus';
                        text = `Appointment scheduled${client ? ` for ${client.name}` : ''}`;
                    } else if (activity.type === 'inventory') {
                        icon = 'fas fa-box-open';
                        text = `Inventory added: ${activity.item.name}`;
                    }
                    
                    const date = new Date(activity.date);
                    const formattedDate = date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                    
                    html += `
                        <div class="client-item">
                            <div class="item-content">
                                <div class="item-title">
                                    <i class="${icon}"></i> ${text}
                                </div>
                                <div class="item-meta">${formattedDate}</div>
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
                this.applyTranslations();
            },
            
            // Render clients list
            renderClients() {
                const container = document.getElementById('clientsList');
                
                if (this.data.clients.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-users"></i>
                            <h3 data-i18n="no_clients">No clients yet</h3>
                            <p data-i18n="no_clients_desc">Start by adding your first client to the system.</p>
                            <button class="btn btn-primary" onclick="app.openModal('addClientModal')">
                                <i class="fas fa-user-plus"></i> <span data-i18n="add_client">Add Client</span>
                            </button>
                        </div>
                    `;
                    return;
                }
                
                let html = '';
                this.data.clients.forEach(client => {
                    const clientAppointments = this.data.appointments.filter(a => a.clientId === client.id);
                    
                    html += `
                        <div class="client-item">
                            <div class="item-content">
                                <div class="item-title">
                                    <i class="fas fa-user"></i> ${client.name}
                                </div>
                                <div class="item-meta">
                                    <div><i class="fas fa-phone"></i> ${client.phone || 'No phone'}</div>
                                    <div><i class="fas fa-envelope"></i> ${client.email || 'No email'}</div>
                                    <div><i class="fas fa-calendar"></i> ${clientAppointments.length} appointments</div>
                                    ${client.notes ? `<div><i class="fas fa-sticky-note"></i> ${client.notes}</div>` : ''}
                                </div>
                            </div>
                            <div class="item-actions">
                                <button class="action-btn btn-primary" onclick="app.editClient(${client.id})">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="action-btn btn-danger" onclick="app.deleteClient(${client.id})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
                this.applyTranslations();
            },
            
            // Render appointments list
            renderAppointments() {
                const container = document.getElementById('appointmentsList');
                
                if (this.data.appointments.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-calendar-times"></i>
                            <h3 data-i18n="no_appointments">No appointments yet</h3>
                            <p data-i18n="no_appointments_desc">Schedule your first appointment to get started.</p>
                            <button class="btn btn-primary" onclick="app.openModal('addAppointmentModal')">
                                <i class="fas fa-calendar-plus"></i> <span data-i18n="schedule_appointment">Schedule Appointment</span>
                            </button>
                        </div>
                    `;
                    return;
                }
                
                // Sort appointments by date and time (most recent first)
                const sortedAppointments = [...this.data.appointments].sort((a, b) => {
                    const dateA = new Date(a.date + 'T' + a.time);
                    const dateB = new Date(b.date + 'T' + b.time);
                    return dateB - dateA;
                });
                
                let html = '';
                sortedAppointments.forEach(appointment => {
                    const client = this.data.clients.find(c => c.id === appointment.clientId);
                    if (!client) return;
                    
                    const appointmentDate = new Date(appointment.date);
                    const now = new Date();
                    const isPast = appointmentDate < now;
                    
                    let statusBadge = '';
                    if (appointment.status === 'completed') {
                        statusBadge = '<span class="badge badge-success">Completed</span>';
                    } else if (appointment.status === 'cancelled') {
                        statusBadge = '<span class="badge badge-danger">Cancelled</span>';
                    } else if (isPast) {
                        statusBadge = '<span class="badge badge-warning">Missed</span>';
                    } else {
                        statusBadge = '<span class="badge badge-primary">Scheduled</span>';
                    }
                    
                    html += `
                        <div class="appointment-item">
                            <div class="item-content">
                                <div class="item-title">
                                    <i class="fas fa-calendar-day"></i> ${client.name} - ${this.getServiceName(appointment.service)}
                                    ${statusBadge}
                                </div>
                                <div class="item-meta">
                                    <div><i class="fas fa-clock"></i> ${appointment.date} at ${appointment.time}</div>
                                    <div><i class="fas fa-stopwatch"></i> ${appointment.duration} minutes</div>
                                    <div><i class="fas fa-dollar-sign"></i> $${appointment.price.toFixed(2)}</div>
                                    ${appointment.notes ? `<div><i class="fas fa-sticky-note"></i> ${appointment.notes}</div>` : ''}
                                </div>
                            </div>
                            <div class="item-actions">
                                <button class="action-btn btn-success" onclick="app.completeAppointment(${appointment.id})">
                                    <i class="fas fa-check"></i>
                                </button>
                                <button class="action-btn btn-warning" onclick="app.editAppointment(${appointment.id})">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="action-btn btn-danger" onclick="app.cancelAppointment(${appointment.id})">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
                this.applyTranslations();
            },
            
            // Render inventory list
            renderInventory() {
                const container = document.getElementById('inventoryList');
                
                if (this.data.inventory.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-boxes"></i>
                            <h3 data-i18n="no_inventory">No inventory items yet</h3>
                            <p data-i18n="no_inventory_desc">Add your first inventory item to track your supplies.</p>
                            <button class="btn btn-primary" onclick="app.openModal('addInventoryModal')">
                                <i class="fas fa-box-open"></i> <span data-i18n="add_inventory">Add Inventory</span>
                            </button>
                        </div>
                    `;
                    return;
                }
                
                let html = '';
                this.data.inventory.forEach(item => {
                    const isLowStock = item.quantity <= item.minStock;
                    const stockClass = isLowStock ? 'low-stock' : '';
                    
                    html += `
                        <div class="inventory-item ${stockClass}">
                            <div class="item-content">
                                <div class="item-title">
                                    <i class="fas fa-box"></i> ${item.name}
                                    ${isLowStock ? '<span class="badge badge-warning">Low Stock</span>' : ''}
                                </div>
                                <div class="item-meta">
                                    <div><i class="fas fa-tag"></i> ${this.getCategoryName(item.category)}</div>
                                    <div><i class="fas fa-cubes"></i> ${item.quantity} in stock (min: ${item.minStock})</div>
                                    <div><i class="fas fa-dollar-sign"></i> $${item.cost.toFixed(2)} per unit</div>
                                    ${item.supplier ? `<div><i class="fas fa-truck"></i> ${item.supplier}</div>` : ''}
                                </div>
                            </div>
                            <div class="item-actions">
                                <button class="action-btn btn-warning" onclick="app.editInventory(${item.id})">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="action-btn btn-danger" onclick="app.deleteInventory(${item.id})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
                this.applyTranslations();
            },
            
            // Render calendar
            renderCalendar() {
                const container = document.getElementById('calendarGrid');
                const currentMonthElement = document.getElementById('currentMonth');
                
                // Set current month and year
                if (!this.calendarDate) {
                    this.calendarDate = new Date();
                }
                
                const month = this.calendarDate.getMonth();
                const year = this.calendarDate.getFullYear();
                
                currentMonthElement.textContent = this.calendarDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
                
                // Get first day of month and number of days
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const daysInMonth = lastDay.getDate();
                
                // Create calendar header
                let html = '';
                const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
                dayNames.forEach(day => {
                    html += `<div class="calendar-day header">${day}</div>`;
                });
                
                // Add empty cells for days before the first day of the month
                for (let i = 0; i < firstDay.getDay(); i++) {
                    html += `<div class="calendar-day"></div>`;
                }
                
                // Add cells for each day of the month
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                for (let day = 1; day <= daysInMonth; day++) {
                    const currentDate = new Date(year, month, day);
                    const dateString = currentDate.toISOString().split('T')[0];
                    const dayAppointments = this.data.appointments.filter(a => a.date === dateString);
                    
                    let dayClass = 'calendar-day';
                    if (currentDate.getTime() === today.getTime()) {
                        dayClass += ' today';
                    }
                    
                    if (dayAppointments.length > 0) {
                        dayClass += ' has-event';
                    }
                    
                    html += `<div class="${dayClass}" data-date="${dateString}">`;
                    html += `<div class="day-number">${day}</div>`;
                    
                    // Add events for this day
                    dayAppointments.slice(0, 2).forEach(appointment => {
                        const client = this.data.clients.find(c => c.id === appointment.clientId);
                        if (client) {
                            html += `<div class="event" title="${client.name} - ${appointment.time}">${appointment.time} - ${client.name.substring(0, 10)}...</div>`;
                        }
                    });
                    
                    if (dayAppointments.length > 2) {
                        html += `<div class="event">+${dayAppointments.length - 2} more</div>`;
                    }
                    
                    html += `</div>`;
                }
                
                container.innerHTML = html;
                
                // Add click event to calendar days
                container.querySelectorAll('.calendar-day:not(.header)').forEach(day => {
                    day.addEventListener('click', () => {
                        const date = day.getAttribute('data-date');
                        if (date) {
                            this.showAppointmentsForDate(date);
                        }
                    });
                });
            },
            
            // Show appointments for a specific date
            showAppointmentsForDate(date) {
                this.showSection('appointments');
                
                // Filter appointments to show only the selected date
                const dateAppointments = this.data.appointments.filter(a => a.date === date);
                
                if (dateAppointments.length === 0) {
                    document.getElementById('appointmentsList').innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-calendar-day"></i>
                            <h3 data-i18n="no_appointments_date">No appointments on ${date}</h3>
                            <p data-i18n="no_appointments_date_desc">Would you like to schedule one?</p>
                            <button class="btn btn-primary" onclick="app.openModal('addAppointmentModal')">
                                <i class="fas fa-calendar-plus"></i> <span data-i18n="schedule_appointment">Schedule Appointment</span>
                            </button>
                        </div>
                    `;
                } else {
                    this.renderAppointments(); // This will show all appointments, we'd need to implement filtering
                }
                
                this.applyTranslations();
            },
            
            // Update reports section
            updateReports() {
                // Update report stats
                document.getElementById('reportTotalClients').textContent = this.data.clients.length;
                
                const currentMonth = new Date().getMonth();
                const currentYear = new Date().getFullYear();
                const monthlyAppointments = this.data.appointments.filter(a => {
                    const appointmentDate = new Date(a.date);
                    return appointmentDate.getMonth() === currentMonth && 
                           appointmentDate.getFullYear() === currentYear;
                });
                document.getElementById('reportMonthlyAppointments').textContent = monthlyAppointments.length;
                
                const totalRevenue = this.data.appointments.reduce((total, a) => total + a.price, 0);
                document.getElementById('reportRevenue').textContent = `$${totalRevenue.toFixed(2)}`;
                
                // Find popular service
                const serviceCounts = {};
                this.data.appointments.forEach(a => {
                    serviceCounts[a.service] = (serviceCounts[a.service] || 0) + 1;
                });
                
                let popularService = '-';
                let maxCount = 0;
                for (const service in serviceCounts) {
                    if (serviceCounts[service] > maxCount) {
                        maxCount = serviceCounts[service];
                        popularService = this.getServiceName(service);
                    }
                }
                
                document.getElementById('reportPopularService').textContent = popularService;
                
                // Render service distribution chart (simplified)
                this.renderServiceChart();
            },
            
            // Render service distribution chart
            renderServiceChart() {
                const container = document.getElementById('serviceChart');
                
                const serviceCounts = {};
                this.data.appointments.forEach(a => {
                    serviceCounts[a.service] = (serviceCounts[a.service] || 0) + 1;
                });
                
                if (Object.keys(serviceCounts).length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-chart-pie"></i>
                            <h3 data-i18n="no_data_chart">No data for chart</h3>
                            <p data-i18n="no_data_chart_desc">Service distribution will appear here after appointments are scheduled.</p>
                        </div>
                    `;
                    return;
                }
                
                let html = '<div class="stats-grid">';
                for (const service in serviceCounts) {
                    const count = serviceCounts[service];
                    const percentage = (count / this.data.appointments.length * 100).toFixed(1);
                    
                    html += `
                        <div class="stat-card">
                            <div class="stat-value">${count}</div>
                            <div class="stat-label">${this.getServiceName(service)}</div>
                            <div class="item-meta">${percentage}% of total</div>
                        </div>
                    `;
                }
                html += '</div>';
                
                container.innerHTML = html;
                this.applyTranslations();
            },
            
            // Filter clients based on search query
            filterClients(query) {
                const container = document.getElementById('clientsList');
                const filteredClients = this.data.clients.filter(client => 
                    client.name.toLowerCase().includes(query.toLowerCase()) ||
                    (client.phone && client.phone.includes(query)) ||
                    (client.email && client.email.toLowerCase().includes(query.toLowerCase())) ||
                    (client.notes && client.notes.toLowerCase().includes(query.toLowerCase()))
                );
                
                if (filteredClients.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-search"></i>
                            <h3 data-i18n="no_clients_found">No clients found</h3>
                            <p data-i18n="no_clients_found_desc">Try adjusting your search terms</p>
                        </div>
                    `;
                    return;
                }
                
                let html = '';
                filteredClients.forEach(client => {
                    const clientAppointments = this.data.appointments.filter(a => a.clientId === client.id);
                    
                    html += `
                        <div class="client-item">
                            <div class="item-content">
                                <div class="item-title">
                                    <i class="fas fa-user"></i> ${client.name}
                                </div>
                                <div class="item-meta">
                                    <div><i class="fas fa-phone"></i> ${client.phone || 'No phone'}</div>
                                    <div><i class="fas fa-envelope"></i> ${client.email || 'No email'}</div>
                                    <div><i class="fas fa-calendar"></i> ${clientAppointments.length} appointments</div>
                                    ${client.notes ? `<div><i class="fas fa-sticky-note"></i> ${client.notes}</div>` : ''}
                                </div>
                            </div>
                            <div class="item-actions">
                                <button class="action-btn btn-primary" onclick="app.editClient(${client.id})">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="action-btn btn-danger" onclick="app.deleteClient(${client.id})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
                this.applyTranslations();
            },
            
            // Filter appointments based on search query
            filterAppointments(query) {
                // Similar implementation to filterClients but for appointments
                // This is a simplified version - in a real app you'd want more robust filtering
                const container = document.getElementById('appointmentsList');
                
                if (!query) {
                    this.renderAppointments();
                    return;
                }
                
                const filteredAppointments = this.data.appointments.filter(appointment => {
                    const client = this.data.clients.find(c => c.id === appointment.clientId);
                    return (
                        client.name.toLowerCase().includes(query.toLowerCase()) ||
                        appointment.service.toLowerCase().includes(query.toLowerCase()) ||
                        (appointment.notes && appointment.notes.toLowerCase().includes(query.toLowerCase()))
                    );
                });
                
                if (filteredAppointments.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-search"></i>
                            <h3 data-i18n="no_appointments_found">No appointments found</h3>
                            <p data-i18n="no_appointments_found_desc">Try adjusting your search terms</p>
                        </div>
                    `;
                    return;
                }
                
                // Render filtered appointments (similar to renderAppointments but with filtered list)
                let html = '';
                filteredAppointments.forEach(appointment => {
                    const client = this.data.clients.find(c => c.id === appointment.clientId);
                    if (!client) return;
                    
                    const appointmentDate = new Date(appointment.date);
                    const now = new Date();
                    const isPast = appointmentDate < now;
                    
                    let statusBadge = '';
                    if (appointment.status === 'completed') {
                        statusBadge = '<span class="badge badge-success">Completed</span>';
                    } else if (appointment.status === 'cancelled') {
                        statusBadge = '<span class="badge badge-danger">Cancelled</span>';
                    } else if (isPast) {
                        statusBadge = '<span class="badge badge-warning">Missed</span>';
                    } else {
                        statusBadge = '<span class="badge badge-primary">Scheduled</span>';
                    }
                    
                    html += `
                        <div class="appointment-item">
                            <div class="item-content">
                                <div class="item-title">
                                    <i class="fas fa-calendar-day"></i> ${client.name} - ${this.getServiceName(appointment.service)}
                                    ${statusBadge}
                                </div>
                                <div class="item-meta">
                                    <div><i class="fas fa-clock"></i> ${appointment.date} at ${appointment.time}</div>
                                    <div><i class="fas fa-stopwatch"></i> ${appointment.duration} minutes</div>
                                    <div><i class="fas fa-dollar-sign"></i> $${appointment.price.toFixed(2)}</div>
                                    ${appointment.notes ? `<div><i class="fas fa-sticky-note"></i> ${appointment.notes}</div>` : ''}
                                </div>
                            </div>
                            <div class="item-actions">
                                <button class="action-btn btn-success" onclick="app.completeAppointment(${appointment.id})">
                                    <i class="fas fa-check"></i>
                                </button>
                                <button class="action-btn btn-warning" onclick="app.editAppointment(${appointment.id})">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="action-btn btn-danger" onclick="app.cancelAppointment(${appointment.id})">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
                this.applyTranslations();
            },
            
            // Filter inventory based on search query
            filterInventory(query) {
                // Similar implementation to filterClients but for inventory
                const container = document.getElementById('inventoryList');
                
                if (!query) {
                    this.renderInventory();
                    return;
                }
                
                const filteredInventory = this.data.inventory.filter(item => 
                    item.name.toLowerCase().includes(query.toLowerCase()) ||
                    item.category.toLowerCase().includes(query.toLowerCase()) ||
                    (item.supplier && item.supplier.toLowerCase().includes(query.toLowerCase()))
                );
                
                if (filteredInventory.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-search"></i>
                            <h3 data-i18n="no_inventory_found">No inventory items found</h3>
                            <p data-i18n="no_inventory_found_desc">Try adjusting your search terms</p>
                        </div>
                    `;
                    return;
                }
                
                let html = '';
                filteredInventory.forEach(item => {
                    const isLowStock = item.quantity <= item.minStock;
                    const stockClass = isLowStock ? 'low-stock' : '';
                    
                    html += `
                        <div class="inventory-item ${stockClass}">
                            <div class="item-content">
                                <div class="item-title">
                                    <i class="fas fa-box"></i> ${item.name}
                                    ${isLowStock ? '<span class="badge badge-warning">Low Stock</span>' : ''}
                                </div>
                                <div class="item-meta">
                                    <div><i class="fas fa-tag"></i> ${this.getCategoryName(item.category)}</div>
                                    <div><i class="fas fa-cubes"></i> ${item.quantity} in stock (min: ${item.minStock})</div>
                                    <div><i class="fas fa-dollar-sign"></i> $${item.cost.toFixed(2)} per unit</div>
                                    ${item.supplier ? `<div><i class="fas fa-truck"></i> ${item.supplier}</div>` : ''}
                                </div>
                            </div>
                            <div class="item-actions">
                                <button class="action-btn btn-warning" onclick="app.editInventory(${item.id})">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="action-btn btn-danger" onclick="app.deleteInventory(${item.id})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
                this.applyTranslations();
            },
            
            // Navigation for calendar
            prevMonth() {
                this.calendarDate.setMonth(this.calendarDate.getMonth() - 1);
                this.renderCalendar();
            },
            
            nextMonth() {
                this.calendarDate.setMonth(this.calendarDate.getMonth() + 1);
                this.renderCalendar();
            },
            
            // Complete an appointment
            completeAppointment(appointmentId) {
                const appointment = this.data.appointments.find(a => a.id === appointmentId);
                if (appointment) {
                    appointment.status = 'completed';
                    this.saveData();
                    this.renderAppointments();
                    this.updateDashboard();
                    this.showToast('Appointment marked as completed', 'success');
                }
            },
            
            // Cancel an appointment
            cancelAppointment(appointmentId) {
                if (confirm('Are you sure you want to cancel this appointment?')) {
                    const appointment = this.data.appointments.find(a => a.id === appointmentId);
                    if (appointment) {
                        appointment.status = 'cancelled';
                        this.saveData();
                        this.renderAppointments();
                        this.updateDashboard();
                        this.showToast('Appointment cancelled', 'success');
                    }
                }
            },
            
            // Delete a client
            deleteClient(clientId) {
                if (confirm('Are you sure you want to delete this client? This will also delete all associated appointments.')) {
                    // Remove client
                    this.data.clients = this.data.clients.filter(c => c.id !== clientId);
                    
                    // Remove associated appointments
                    this.data.appointments = this.data.appointments.filter(a => a.clientId !== clientId);
                    
                    this.saveData();
                    this.renderClients();
                    this.renderAppointments();
                    this.updateDashboard();
                    this.showToast('Client deleted successfully', 'success');
                }
            },
            
            // Delete an inventory item
            deleteInventory(inventoryId) {
                if (confirm('Are you sure you want to delete this inventory item?')) {
                    this.data.inventory = this.data.inventory.filter(i => i.id !== inventoryId);
                    this.saveData();
                    this.renderInventory();
                    this.updateDashboard();
                    this.showToast('Inventory item deleted successfully', 'success');
                }
            },
            
            // Edit a client (placeholder - in a real app you'd implement this)
            editClient(clientId) {
                this.showToast('Edit functionality would be implemented in a full version', 'info');
            },
            
            // Edit an appointment (placeholder)
            editAppointment(appointmentId) {
                this.showToast('Edit functionality would be implemented in a full version', 'info');
            },
            
            // Edit an inventory item (placeholder)
            editInventory(inventoryId) {
                this.showToast('Edit functionality would be implemented in a full version', 'info');
            },
            
            // Generate a report (placeholder)
            generateReport() {
                this.showToast('Report generation would be implemented in a full version', 'info');
            },
            
            // Export data
            exportData(type) {
                let dataToExport;
                
                if (type === 'clients') {
                    dataToExport = this.data.clients;
                } else if (type === 'appointments') {
                    dataToExport = this.data.appointments;
                } else if (type === 'inventory') {
                    dataToExport = this.data.inventory;
                } else {
                    dataToExport = this.data;
                }
                
                const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(dataToExport, null, 2));
                const downloadAnchorNode = document.createElement('a');
                downloadAnchorNode.setAttribute("href", dataStr);
                downloadAnchorNode.setAttribute("download", `hairsalon-data-${type}-${new Date().toISOString().split('T')[0]}.json`);
                document.body.appendChild(downloadAnchorNode);
                downloadAnchorNode.click();
                downloadAnchorNode.remove();
                
                this.showToast('Data exported successfully', 'success');
            },
            
            // Show a toast notification
            showToast(message, type = 'info') {
                const toast = document.getElementById('toast');
                toast.textContent = message;
                toast.className = 'toast show';
                
                // Add type class if provided
                if (type) {
                    toast.classList.add(type);
                }
                
                // Hide after 3 seconds
                setTimeout(() => {
                    toast.classList.remove('show');
                }, 3000);
            },
            
            // Generate a unique ID
            generateId() {
                return Date.now() + Math.floor(Math.random() * 1000);
            },
            
            // Get service name for display
            getServiceName(serviceKey) {
                const services = {
                    'haircut': 'Haircut',
                    'coloring': 'Coloring',
                    'styling': 'Styling',
                    'treatment': 'Treatment',
                    'extension': 'Extension',
                    'other': 'Other'
                };
                
                return services[serviceKey] || serviceKey;
            },
            
            // Get category name for display
            getCategoryName(categoryKey) {
                const categories = {
                    'shampoo': 'Shampoo',
                    'conditioner': 'Conditioner',
                    'color': 'Color',
                    'treatment': 'Treatment',
                    'styling': 'Styling',
                    'tools': 'Tools',
                    'other': 'Other'
                };
                
                return categories[categoryKey] || categoryKey;
            },
            
            // Language and translation functionality
            setupLanguage() {
                // Set initial language
                const savedLanguage = localStorage.getItem('hairsalon-language') || 'en';
                document.getElementById('languageSelect').value = savedLanguage;
                this.changeLanguage(savedLanguage);
            },
            
            changeLanguage(language) {
                this.data.settings.language = language;
                localStorage.setItem('hairsalon-language', language);
                this.applyTranslations();
            },
            
            applyTranslations() {
                // This is a simplified translation system
                // In a real app, you would have proper translation files
                const elements = document.querySelectorAll('[data-i18n]');
                
                elements.forEach(element => {
                    const key = element.getAttribute('data-i18n');
                    const translation = this.getTranslation(key, this.data.settings.language);
                    if (translation) {
                        element.textContent = translation;
                    }
                });
                
                // Handle placeholders
                const placeholders = document.querySelectorAll('[data-i18n-placeholder]');
                placeholders.forEach(element => {
                    const key = element.getAttribute('data-i18n-placeholder');
                    const translation = this.getTranslation(key, this.data.settings.language);
                    if (translation) {
                        element.placeholder = translation;
                    }
                });
            },
            
            getTranslation(key, language) {
                // Simplified translation dictionary
                // In a real app, this would be in separate JSON files
                const translations = {
                    'en': {
                        'dashboard': 'Dashboard',
                        'clients': 'Clients',
                        'appointments': 'Appointments',
                        'inventory': 'Inventory',
                        'calendar': 'Calendar',
                        'reports': 'Reports',
                        'add_client': 'Add Client',
                        'schedule_appointment': 'Schedule Appointment',
                        'add_inventory': 'Add Inventory',
                        'salon_overview': 'Salon Overview',
                        'backup_data': 'Backup Data',
                        'total_clients': 'Total Clients',
                        'today_appointments': "Today's Appointments",
                        'low_stock': 'Low Stock Items',
                        'monthly_revenue': 'Monthly Revenue',
                        'todays_appointments': "Today's Appointments",
                        'view_all': 'View All',
                        'recent_activity': 'Recent Activity',
                        'client_management': 'Client Management',
                        'search_clients': 'Search clients...',
                        'appointment_scheduling': 'Appointment Scheduling',
                        'search_appointments': 'Search appointments...',
                        'inventory_management': 'Inventory Management',
                        'search_inventory': 'Search inventory...',
                        'appointment_calendar': 'Appointment Calendar',
                        'prev_month': 'Prev Month',
                        'next_month': 'Next Month',
                        'salon_reports': 'Salon Reports',
                        'export_report': 'Export Report',
                        'monthly_appointments': 'Monthly Appointments',
                        'total_revenue': 'Total Revenue',
                        'popular_service': 'Popular Service',
                        'service_distribution': 'Service Distribution',
                        'client_name': 'Client Name',
                        'phone_number': 'Phone Number',
                        'email': 'Email',
                        'notes': 'Notes',
                        'save_client': 'Save Client',
                        'cancel': 'Cancel',
                        'select_client': 'Select Client',
                        'date': 'Date',
                        'time': 'Time',
                        'service': 'Service',
                        'select_service': 'Select Service',
                        'haircut': 'Haircut',
                        'coloring': 'Coloring',
                        'styling': 'Styling',
                        'treatment': 'Treatment',
                        'extension': 'Extension',
                        'other': 'Other',
                        'duration': 'Duration (minutes)',
                        'price': 'Price ($)',
                        'save_appointment': 'Save Appointment',
                        'products_used': 'Products Used',
                        'select_product': 'Select Product',
                        'add': 'Add',
                        'product_name': 'Product Name',
                        'category': 'Category',
                        'select_category': 'Select Category',
                        'shampoo': 'Shampoo',
                        'conditioner': 'Conditioner',
                        'color': 'Color',
                        'tools': 'Tools',
                        'quantity': 'Quantity',
                        'min_stock': 'Minimum Stock',
                        'cost_per_unit': 'Cost per Unit ($)',
                        'supplier': 'Supplier',
                        'save_inventory': 'Save Inventory',
                        'install_app': 'Install App',
                        'install_prompt': 'Install HairSalon Pro for easy access',
                        'install': 'Install',
                        'dismiss': 'Dismiss',
                        'no_appointments_today': 'No appointments today',
                        'no_appointments_today_desc': "You're all caught up! Enjoy your day or schedule new appointments.",
                        'no_recent_activity': 'No recent activity',
                        'no_recent_activity_desc': 'Activities will appear here as you use the app.',
                        'no_clients': 'No clients yet',
                        'no_clients_desc': 'Start by adding your first client to the system.',
                        'no_appointments': 'No appointments yet',
                        'no_appointments_desc': 'Schedule your first appointment to get started.',
                        'no_inventory': 'No inventory items yet',
                        'no_inventory_desc': 'Add your first inventory item to track your supplies.',
                        'no_appointments_date': 'No appointments on this date',
                        'no_appointments_date_desc': 'Would you like to schedule one?',
                        'no_data_chart': 'No data for chart',
                        'no_data_chart_desc': 'Service distribution will appear here after appointments are scheduled.',
                        'no_clients_found': 'No clients found',
                        'no_clients_found_desc': 'Try adjusting your search terms',
                        'no_appointments_found': 'No appointments found',
                        'no_appointments_found_desc': 'Try adjusting your search terms',
                        'no_inventory_found': 'No inventory items found',
                        'no_inventory_found_desc': 'Try adjusting your search terms',
                        'main_navigation': 'Main Navigation',
                        'quick_actions': 'Quick Actions',
                        'tagline': 'Professional Hairdresser Management System'
                    },
                    'es': {
                        'dashboard': 'Panel de Control',
                        'clients': 'Clientes',
                        'appointments': 'Citas',
                        'inventory': 'Inventario',
                        'calendar': 'Calendario',
                        'reports': 'Informes',
                        'add_client': 'Agregar Cliente',
                        'schedule_appointment': 'Programar Cita',
                        'add_inventory': 'Agregar Inventario',
                        'salon_overview': 'Resumen del Salón',
                        'backup_data': 'Respaldar Datos',
                        'total_clients': 'Total de Clientes',
                        'today_appointments': 'Citas de Hoy',
                        'low_stock': 'Artículos con Stock Bajo',
                        'monthly_revenue': 'Ingresos Mensuales',
                        'todays_appointments': 'Citas de Hoy',
                        'view_all': 'Ver Todos',
                        'recent_activity': 'Actividad Reciente',
                        'client_management': 'Gestión de Clientes',
                        'search_clients': 'Buscar clientes...',
                        'appointment_scheduling': 'Programación de Citas',
                        'search_appointments': 'Buscar citas...',
                        'inventory_management': 'Gestión de Inventario',
                        'search_inventory': 'Buscar en inventario...',
                        'appointment_calendar': 'Calendario de Citas',
                        'prev_month': 'Mes Anterior',
                        'next_month': 'Mes Siguiente',
                        'salon_reports': 'Informes del Salón',
                        'export_report': 'Exportar Informe',
                        'monthly_appointments': 'Citas Mensuales',
                        'total_revenue': 'Ingresos Totales',
                        'popular_service': 'Servicio Popular',
                        'service_distribution': 'Distribución de Servicios',
                        'client_name': 'Nombre del Cliente',
                        'phone_number': 'Número de Teléfono',
                        'email': 'Correo Electrónico',
                        'notes': 'Notas',
                        'save_client': 'Guardar Cliente',
                        'cancel': 'Cancelar',
                        'select_client': 'Seleccionar Cliente',
                        'date': 'Fecha',
                        'time': 'Hora',
                        'service': 'Servicio',
                        'select_service': 'Seleccionar Servicio',
                        'haircut': 'Corte de Pelo',
                        'coloring': 'Coloración',
                        'styling': 'Estilizado',
                        'treatment': 'Tratamiento',
                        'extension': 'Extensiones',
                        'other': 'Otro',
                        'duration': 'Duración (minutos)',
                        'price': 'Precio ($)',
                        'save_appointment': 'Guardar Cita',
                        'products_used': 'Productos Utilizados',
                        'select_product': 'Seleccionar Producto',
                        'add': 'Agregar',
                        'product_name': 'Nombre del Producto',
                        'category': 'Categoría',
                        'select_category': 'Seleccionar Categoría',
                        'shampoo': 'Champú',
                        'conditioner': 'Acondicionador',
                        'color': 'Color',
                        'tools': 'Herramientas',
                        'quantity': 'Cantidad',
                        'min_stock': 'Stock Mínimo',
                        'cost_per_unit': 'Costo por Unidad ($)',
                        'supplier': 'Proveedor',
                        'save_inventory': 'Guardar Inventario',
                        'install_app': 'Instalar App',
                        'install_prompt': 'Instala HairSalon Pro para acceso fácil',
                        'install': 'Instalar',
                        'dismiss': 'Descartar',
                        'no_appointments_today': 'No hay citas hoy',
                        'no_appointments_today_desc': '¡Estás al día! Disfruta tu día o programa nuevas citas.',
                        'no_recent_activity': 'No hay actividad reciente',
                        'no_recent_activity_desc': 'Las actividades aparecerán aquí a medida que uses la aplicación.',
                        'no_clients': 'Aún no hay clientes',
                        'no_clients_desc': 'Comienza agregando tu primer cliente al sistema.',
                        'no_appointments': 'Aún no hay citas',
                        'no_appointments_desc': 'Programa tu primera cita para comenzar.',
                        'no_inventory': 'Aún no hay artículos en inventario',
                        'no_inventory_desc': 'Agrega tu primer artículo de inventario para rastrear tus suministros.',
                        'no_appointments_date': 'No hay citas en esta fecha',
                        'no_appointments_date_desc': '¿Te gustaría programar una?',
                        'no_data_chart': 'No hay datos para el gráfico',
                        'no_data_chart_desc': 'La distribución de servicios aparecerá aquí después de programar citas.',
                        'no_clients_found': 'No se encontraron clientes',
                        'no_clients_found_desc': 'Intenta ajustar tus términos de búsqueda',
                        'no_appointments_found': 'No se encontraron citas',
                        'no_appointments_found_desc': 'Intenta ajustar tus términos de búsqueda',
                        'no_inventory_found': 'No se encontraron artículos en inventario',
                        'no_inventory_found_desc': 'Intenta ajustar tus términos de búsqueda',
                        'main_navigation': 'Navegación Principal',
                        'quick_actions': 'Acciones Rápidas',
                        'tagline': 'Sistema Profesional de Gestión para Peluqueros'
                    }
                    // Additional languages would be added here
                };
                
                return translations[language]?.[key] || key;
            }
        };

        // Initialize the app when the DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            app.init();
        });

        // Close modals when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                e.target.style.display = 'none';
            }
        });
    </script>
</body>
</html>
