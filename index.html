<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HairSalon Pro - Calendar Edition</title>
    <meta name="description" content="Complete hairdresser salon management system with an interactive calendar.">
    <meta name="theme-color" content="#e91e63">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="HairSalon Pro">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="manifest" href="manifest.json">
</head>
    <style>
        :root {
            --primary: #e91e63; --primary-dark: #c2185b; --primary-light: #f8bbd9; --secondary: #9c27b0; --accent: #ff9800; --dark: #0d1117; --darker: #010409; --dark-gray: #161b22; --light: #f5f5f5; --success: #4caf50; --warning: #ff9800; --danger: #f44336; --border-radius: 16px; --shadow: 0 12px 40px rgba(0,0,0,0.4); --transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: linear-gradient(135deg, var(--darker) 0%, var(--dark) 100%); color: var(--light); line-height: 1.7; min-height: 100vh; overflow-x: hidden; }
        .app-container { display: flex; min-height: 100vh; }
        .sidebar { width: 280px; background: linear-gradient(180deg, var(--dark-gray) 0%, var(--darker) 100%); border-right: 1px solid #30363d; padding: 2rem 0; display: flex; flex-direction: column; position: fixed; top: 0; left: 0; height: 100vh; box-shadow: 2px 0 20px rgba(0,0,0,0.6); z-index: 1000; transition: var(--transition); }
        .logo { color: var(--primary); font-size: 2rem; text-align: center; margin-bottom: 3rem; text-shadow: 0 0 15px rgba(233, 30, 99, 0.5); letter-spacing: 1.5px; padding: 0 1.5rem; font-weight: 700; }
        .logo i { margin-right: 10px; }
        .nav-section { margin-bottom: 2rem; }
        .nav-section-title { color: var(--primary); font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; padding: 0 2rem; margin-bottom: 1rem; opacity: 0.7; font-weight: 600; }
        .nav-link { display: flex; align-items: center; padding: 1rem 2rem; color: var(--light); text-decoration: none; font-weight: 600; transition: var(--transition); border-left: 4px solid transparent; margin: 0.15rem 0; cursor: pointer; }
        .nav-link:hover { background: linear-gradient(90deg, rgba(233, 30, 99, 0.1) 0%, transparent 100%); color: var(--primary); border-left-color: var(--primary); }
        .nav-link.active { background: linear-gradient(90deg, rgba(233, 30, 99, 0.15) 0%, transparent 100%); color: var(--primary); border-left-color: var(--primary); }
        .nav-link i { margin-right: 15px; font-size: 1.3rem; width: 20px; text-align: center; }
        .language-selector { padding: 0 2rem; margin-top: auto; margin-bottom: 1rem; }
        .language-selector select { width: 100%; padding: 10px; background: var(--dark); border: 1px solid #30363d; border-radius: 8px; color: var(--light); font-size: 0.9rem; }
        .main-content { flex-grow: 1; margin-left: 280px; padding: 20px; transition: var(--transition); }
        .app-header { background: linear-gradient(135deg, var(--dark) 0%, var(--dark-gray) 100%); padding: 25px; text-align: center; border-radius: var(--border-radius); margin-bottom: 25px; box-shadow: var(--shadow); border: 1px solid rgba(255,255,255,0.1); position: relative; overflow: hidden; }
        .app-header::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent)); }
        .tagline { color: var(--primary-light); font-size: 1.2em; opacity: 0.9; margin-bottom: 20px; font-weight: 300; }
        .install-btn { background: linear-gradient(135deg, var(--success) 0%, #66bb6a 100%); color: white; border: none; padding: 14px 28px; border-radius: var(--border-radius); cursor: pointer; font-weight: 600; transition: var(--transition); display: none; box-shadow: 0 6px 20px rgba(76, 175, 80, 0.3); min-height: 50px; min-width: 140px; position: relative; overflow: hidden; }
        .install-btn.pulse { animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        .install-btn:hover { transform: translateY(-3px) scale(1.05); box-shadow: 0 10px 30px rgba(76, 175, 80, 0.4); }
        .section { display: none; animation: fadeInUp 0.6s ease; }
        .section.active { display: block; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        .card { background: linear-gradient(135deg, var(--dark-gray) 0%, #2d2d2d 100%); border-radius: var(--border-radius); padding: 25px; margin-bottom: 20px; box-shadow: var(--shadow); border: 1px solid rgba(255,255,255,0.08); transition: var(--transition); position: relative; overflow: hidden; }
        .card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, var(--primary), var(--secondary)); transform: scaleX(0); transition: var(--transition); }
        .card:hover::before { transform: scaleX(1); }
        .card:hover { transform: translateY(-5px); box-shadow: 0 15px 40px rgba(0,0,0,0.5); }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid var(--primary); }
        .card-title { font-size: 1.5em; color: var(--primary); display: flex; align-items: center; gap: 12px; font-weight: 700; }
        .btn { padding: 14px 24px; border: none; border-radius: var(--border-radius); cursor: pointer; font-weight: 600; transition: var(--transition); display: inline-flex; align-items: center; gap: 8px; font-size: 1em; position: relative; overflow: hidden; min-height: 44px; min-width: 44px; }
        .btn-primary { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); color: var(--darker); box-shadow: 0 6px 20px rgba(233, 30, 99, 0.3); }
        .btn-primary:hover { transform: translateY(-3px) scale(1.05); box-shadow: 0 10px 30px rgba(233, 30, 99, 0.4); }
        .btn-success { background: linear-gradient(135deg, var(--success) 0%, #66bb6a 100%); color: white; }
        .btn-danger { background: linear-gradient(135deg, var(--danger) 0%, #ef5350 100%); color: white; }
        .btn-secondary { background: linear-gradient(135deg, var(--secondary) 0%, #7b1fa2 100%); color: white; }
        .btn-outline { background: transparent; border: 2px solid var(--primary); color: var(--primary); padding: 12px 22px; }
        .btn-outline:hover { background: var(--primary); color: var(--darker); transform: translateY(-2px); }
        .btn-sm { padding: 8px 12px; font-size: 0.9em; min-height: 36px; min-width: 36px; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 25px 0; }
        .stat-card { background: linear-gradient(135deg, var(--dark) 0%, var(--dark-gray) 100%); padding: 25px; text-align: center; border-radius: var(--border-radius); border-left: 5px solid var(--primary); transition: var(--transition); cursor: pointer; position: relative; overflow: hidden; }
        .stat-card:hover { transform: translateY(-8px) scale(1.03); box-shadow: var(--shadow); border-left-color: var(--secondary); }
        .stat-value { font-size: 2.5em; font-weight: bold; color: var(--primary); margin-bottom: 8px; line-height: 1; text-shadow: 0 4px 15px rgba(233, 30, 99, 0.3); }
        .stat-label { color: var(--light); opacity: 0.9; font-size: 0.95em; font-weight: 600; }
        .empty-state { text-align: center; padding: 60px 30px; color: rgba(255,255,255,0.6); }
        .empty-state i { font-size: 4em; margin-bottom: 20px; opacity: 0.4; background: linear-gradient(135deg, var(--primary), var(--secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; filter: drop-shadow(0 4px 15px rgba(0,0,0,0.3)); }
        .empty-state h3 { font-size: 1.6em; margin-bottom: 12px; color: rgba(255,255,255,0.8); font-weight: 600; }
        .empty-state p { font-size: 1em; margin-bottom: 25px; opacity: 0.8; line-height: 1.6; }
        .toast { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, var(--success) 0%, #66bb6a 100%); color: white; padding: 16px 24px; border-radius: var(--border-radius); z-index: 2001; display: none; box-shadow: var(--shadow); animation: toastSlideUp 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94); font-weight: 600; backdrop-filter: blur(10px); max-width: 90%; text-align: center; }
        .toast.show { display: block; }
        .install-prompt { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%); color: var(--darker); padding: 20px 25px; border-radius: var(--border-radius); box-shadow: var(--shadow); z-index: 2000; display: none; gap: 20px; align-items: center; flex-wrap: wrap; justify-content: center; max-width: 90%; animation: toastSlideUp 0.4s ease; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2); font-weight: 600; }
        .install-prompt.show { display: flex; }
        @keyframes toastSlideUp { from { bottom: -60px; opacity: 0; } to { bottom: 30px; opacity: 1; } }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 2000; backdrop-filter: blur(5px); animation: fadeIn 0.3s ease; }
        .modal.show { display: flex; align-items: center; justify-content: center; }
        .modal-content { background: linear-gradient(135deg, var(--dark) 0%, var(--dark-gray) 100%); border-radius: var(--border-radius); padding: 30px; width: 90%; max-width: 600px; box-shadow: var(--shadow); border: 1px solid rgba(255,255,255,0.1); animation: modalSlideUp 0.4s ease; position: relative; }
        @keyframes modalSlideUp { from { opacity: 0; transform: translateY(50px); } to { opacity: 1; transform: translateY(0); } }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 2px solid var(--primary); }
        .modal-title { font-size: 1.5em; color: var(--primary); display: flex; align-items: center; gap: 10px; font-weight: 700; }
        .close-modal { background: none; border: none; color: var(--light); font-size: 1.5em; cursor: pointer; transition: var(--transition); width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 50%; }
        .close-modal:hover { background: rgba(255,255,255,0.1); color: var(--primary); }
        .form-group { margin-bottom: 20px; }
        .form-label { display: block; margin-bottom: 8px; color: var(--light); font-weight: 600; }
        .form-control { width: 100%; padding: 14px; background: var(--dark); border: 1px solid #30363d; border-radius: 8px; color: var(--light); font-size: 1em; transition: var(--transition); }
        .form-control:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(233, 30, 99, 0.2); }
        .form-actions { display: flex; gap: 15px; justify-content: flex-end; margin-top: 25px; }
        .data-list { display: grid; gap: 15px; }
        .data-item { background: linear-gradient(135deg, rgba(42,42,42,0.8) 0%, rgba(50,50,50,0.6) 100%); padding: 20px; border-radius: 12px; border-left: 4px solid var(--primary); transition: var(--transition); display: flex; justify-content: space-between; align-items: center; }
        .data-item.appointment-item { border-left: 4px solid var(--secondary); }
        .data-item.inventory-item { border-left: 4px solid var(--accent); }
        .data-item:hover { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(0,0,0,0.3); }
        .data-item.completed { border-left-color: var(--success); background: linear-gradient(135deg, rgba(22, 27, 34, 0.8) 0%, rgba(22, 27, 34, 0.6) 100%); opacity: 0.8; }
        .data-item-content h4 { color: var(--light); margin-bottom: 8px; font-size: 1.1em; }
        .data-item-content h4 .status-badge { font-size: 0.7em; padding: 4px 8px; border-radius: 8px; background: var(--success); color: white; margin-left: 10px; vertical-align: middle; font-weight: 600; }
        .data-item-content p { color: rgba(255,255,255,0.7); font-size: 0.9em; margin-bottom: 5px; }
        .data-item-content span { display: block; font-size: 0.8em; color: var(--primary-light); margin-top: 5px; }
        .data-item-content .products-used { font-size: 0.85em; color: rgba(255,255,255,0.6); margin-top: 8px; font-style: italic; }
        .products-used i { margin-right: 5px; color: var(--accent); }
        .data-item-actions { display: flex; gap: 10px; flex-shrink: 0; }
        .data-item.low-stock { border-left-color: var(--danger); }
        
        /* CALENDAR STYLES */
        .calendar-container { padding: 20px; background: linear-gradient(135deg, var(--dark-gray) 0%, #2d2d2d 100%); border-radius: var(--border-radius); }
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; color: var(--primary-light); }
        .calendar-header button { background: none; border: 2px solid var(--primary-light); color: var(--primary-light); border-radius: 50%; width: 40px; height: 40px; cursor: pointer; transition: var(--transition); }
        .calendar-header button:hover { background: var(--primary); color: var(--dark); border-color: var(--primary); }
        #calendarMonthYear { font-size: 1.5em; font-weight: 600; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; }
        .calendar-grid div { text-align: center; padding: 10px; }
        .calendar-weekday { font-weight: bold; color: var(--primary); opacity: 0.8; padding: 10px 5px; }
        .calendar-day { min-height: 60px; background: rgba(0,0,0,0.2); border-radius: 8px; cursor: pointer; transition: var(--transition); position: relative; border: 2px solid transparent; display: flex; align-items: center; justify-content: center; font-size: 1.1em;}
        .calendar-day:hover { background: var(--dark); border-color: var(--primary); }
        .calendar-day.other-month { opacity: 0.3; cursor: default; }
        .calendar-day.other-month:hover { background: rgba(0,0,0,0.2); border-color: transparent; }
        .calendar-day.today { border-color: var(--accent); font-weight: bold; color: var(--accent); }
        .calendar-day.selected { background: var(--primary); color: var(--dark); font-weight: bold; }
        .calendar-day .event-dot { position: absolute; bottom: 8px; left: 50%; transform: translateX(-50%); width: 6px; height: 6px; background-color: var(--accent); border-radius: 50%; }
        #selectedDayAppointments { margin-top: 20px; }
        
        @media (max-width: 768px) {
            .sidebar { width: 70px; }
            .logo span, .nav-link span, .nav-section-title { display: none; }
            .nav-link { justify-content: center; padding: 1rem; }
            .nav-link i { margin-right: 0; }
            .main-content { margin-left: 70px; padding: 15px; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); gap: 15px; }
            .data-item { flex-direction: column; align-items: flex-start; gap: 15px; }
            .data-item-actions { width: 100%; justify-content: flex-end; }
        }
        @media (max-width: 480px) {
            .stats-grid { grid-template-columns: 1fr; }
            .card { padding: 18px 15px; }
            .modal-content { padding: 20px; }
            .form-actions { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <nav class="sidebar">
            <div class="logo"><i class="fas fa-scissors"></i> <span>HairSalon Pro</span></div>
            <div class="nav-section">
                <div class="nav-section-title" data-i18n="main_navigation"></div>
                <a class="nav-link active" data-section="dashboard"><i class="fas fa-tachometer-alt"></i> <span data-i18n="dashboard"></span></a>
                <a class="nav-link" data-section="calendar"><i class="fas fa-calendar-alt"></i> <span data-i18n="calendar"></span></a>
                <a class="nav-link" data-section="clients"><i class="fas fa-users"></i> <span data-i18n="clients"></span></a>
                <a class="nav-link" data-section="appointments"><i class="fas fa-calendar-check"></i> <span data-i18n="appointments"></span></a>
                <a class="nav-link" data-section="inventory"><i class="fas fa-boxes"></i> <span data-i18n="inventory"></span></a>
            </div>
            <div class="nav-section">
                <div class="nav-section-title" data-i18n="quick_actions"></div>
                <a class="nav-link" id="quickAddClient"><i class="fas fa-user-plus"></i> <span data-i18n="add_client"></span></a>
                <a class="nav-link" id="quickAddAppointment"><i class="fas fa-calendar-plus"></i> <span data-i18n="schedule_appointment"></span></a>
            </div>
            <div class="language-selector">
                <select id="languageSelect">
                    <option value="en">English</option> <option value="es">Español</option> <option value="ru">Русский</option> <option value="he">עברית</option>
                </select>
            </div>
        </nav>

        <div class="main-content">
            <div class="app-header">
                <div class="logo"><i class="fas fa-scissors"></i> HairSalon Pro</div>
                <div class="tagline" data-i18n="tagline"></div>
                <button class="install-btn" id="installButton"><i class="fas fa-download"></i> <span data-i18n="install_app"></span></button>
            </div>

            <section id="dashboard" class="section active"></section>
            
            <section id="calendar" class="section">
                <div class="card">
                    <div class="calendar-container">
                        <div class="calendar-header">
                            <button id="prevMonthBtn"><i class="fas fa-chevron-left"></i></button>
                            <h2 id="calendarMonthYear"></h2>
                            <button id="nextMonthBtn"><i class="fas fa-chevron-right"></i></button>
                        </div>
                        <div class="calendar-grid" id="calendarWeekdays"></div>
                        <div class="calendar-grid" id="calendarDays"></div>
                    </div>
                </div>
                <div class="card" id="selectedDayAppointments">
                     <div class="card-header">
                        <h2 class="card-title" id="selectedDayTitle"><i class="fas fa-clipboard-list"></i> <span data-i18n="appointments_for_date"></span></h2>
                        <button class="btn btn-primary" id="addAppointmentForSelectedDay"><i class="fas fa-plus"></i> <span data-i18n="add_appointment"></span></button>
                    </div>
                    <div class="data-list" id="selectedDayAppointmentsList"></div>
                </div>
            </section>

            <section id="clients" class="section"></section>
            <section id="appointments" class="section"></section>
            <section id="inventory" class="section"></section>
        </div>
    </div>

    <div class="modal" id="addClientModal"></div>
    <div class="modal" id="addAppointmentModal"></div>
    <div class="modal" id="addInventoryModal"></div>

    <div class="toast" id="toast"></div>
    <div class="install-prompt" id="installPrompt"></div>
    
    <script>
        class HairSalonPro {
            constructor() {
                this.clients = JSON.parse(localStorage.getItem('hairsalon_clients')) || [];
                this.appointments = JSON.parse(localStorage.getItem('hairsalon_appointments')) || [];
                this.inventory = JSON.parse(localStorage.getItem('hairsalon_inventory')) || [];
                this.currentLanguage = localStorage.getItem('hairsalon_language') || 'en';
                this.deferredPrompt = null;
                this.currentDate = new Date();
                this.selectedDate = new Date();
                this.initDOM();
                this.initTranslations();
                this.setupEventListeners();
                this.translateUI();
                this.refreshAll();
            }

            initDOM() {
                const sections = {
                    dashboard: `<div class="card"><div class="card-header"><h2 class="card-title"><i class="fas fa-tachometer-alt"></i> <span data-i18n="salon_overview"></span></h2></div><div class="stats-grid"><div class="stat-card" onclick="app.showSection('clients')"><div class="stat-value" id="totalClients">0</div><div class="stat-label" data-i18n="total_clients"></div></div><div class="stat-card" onclick="app.showSection('appointments')"><div class="stat-value" id="todayAppointments">0</div><div class="stat-label" data-i18n="today_appointments"></div></div><div class="stat-card" onclick="app.showSection('inventory')"><div class="stat-value" id="lowStockItems">0</div><div class="stat-label" data-i18n="low_stock"></div></div><div class="stat-card"><div class="stat-value" id="monthlyRevenue">$0</div><div class="stat-label" data-i18n="monthly_revenue"></div></div></div></div>`,
                    clients: `<div class="card"><div class="card-header"><h2 class="card-title"><i class="fas fa-users"></i> <span data-i18n="client_management"></span></h2><button class="btn btn-primary" onclick="app.openModal('addClientModal')"><i class="fas fa-plus"></i> <span data-i18n="new_client"></span></button></div><div class="data-list" id="clientsList"><div class="empty-state"><i class="fas fa-users"></i><h3 data-i18n="no_clients_yet"></h3><p data-i18n="build_client_database"></p><button class="btn btn-primary" onclick="app.openModal('addClientModal')"><i class="fas fa-plus"></i> <span data-i18n="add_first_client"></span></button></div></div></div>`,
                    appointments: `<div class="card"><div class="card-header"><h2 class="card-title"><i class="fas fa-calendar-alt"></i> <span data-i18n="appointment_management"></span></h2><button class="btn btn-primary" onclick="app.openModal('addAppointmentModal')"><i class="fas fa-plus"></i> <span data-i18n="new_appointment"></span></button></div><div class="data-list" id="appointmentsList"><div class="empty-state"><i class="fas fa-calendar-plus"></i><h3 data-i18n="no_appointments_scheduled"></h3><p data-i18n="schedule_first_appointment"></p><button class="btn btn-primary" onclick="app.openModal('addAppointmentModal')"><i class="fas fa-plus"></i> <span data-i18n="create_first_appointment"></span></button></div></div></div>`,
                    inventory: `<div class="card"><div class="card-header"><h2 class="card-title"><i class="fas fa-boxes"></i> <span data-i18n="inventory_management"></span></h2><button class="btn btn-primary" onclick="app.openModal('addInventoryModal')"><i class="fas fa-plus"></i> <span data-i18n="new_item"></span></button></div><div class="data-list" id="inventoryList"><div class="empty-state"><i class="fas fa-box-open"></i><h3 data-i18n="no_inventory_items"></h3><p data-i18n="track_supplies"></p><button class="btn btn-primary" onclick="app.openModal('addInventoryModal')"><i class="fas fa-plus"></i> <span data-i18n="add_first_item"></span></button></div></div></div>`
                };
                for (const [id, content] of Object.entries(sections)) { document.getElementById(id).innerHTML = content; }
                
                const modals = {
                    addClientModal: `<div class="modal-content"><div class="modal-header"><h3 class="modal-title" id="clientModalTitle"><i class="fas fa-user-plus"></i> <span data-i18n="add_new_client"></span></h3><button type="button" class="close-modal" onclick="app.closeModal('addClientModal')">&times;</button></div><form id="clientForm"><input type="hidden" id="clientId"><div class="form-group"><label class="form-label" for="clientName" data-i18n="client_name"></label><input type="text" class="form-control" id="clientName" required></div><div class="form-group"><label class="form-label" for="clientPhone" data-i18n="phone_number"></label><input type="tel" class="form-control" id="clientPhone"></div><div class="form-group"><label class="form-label" for="clientEmail" data-i18n="email_address"></label><input type="email" class="form-control" id="clientEmail"></div><div class="form-group"><label class="form-label" for="clientNotes" data-i18n="notes"></label><textarea class="form-control" id="clientNotes" rows="3"></textarea></div><div class="form-actions"><button type="button" class="btn btn-outline" onclick="app.closeModal('addClientModal')" data-i18n="cancel"></button><button type="submit" class="btn btn-primary" id="saveClientButton" data-i18n="save_client"></button></div></form></div>`,
                    addAppointmentModal: `<div class="modal-content"><div class="modal-header"><h3 class="modal-title" id="appointmentModalTitle"><i class="fas fa-calendar-plus"></i> <span data-i18n="schedule_appointment"></span></h3><button type="button" class="close-modal" onclick="app.closeModal('addAppointmentModal')">&times;</button></div><form id="appointmentForm"><input type="hidden" id="appointmentId"><div class="form-group"><label class="form-label" for="appointmentClient" data-i18n="select_client"></label><select class="form-control" id="appointmentClient" required></select></div><div class="form-group"><label class="form-label" for="appointmentTitle" data-i18n="appointment_title"></label><input type="text" class="form-control" id="appointmentTitle" required></div><div class="form-group"><label class="form-label" for="appointmentDateTime" data-i18n="date_time"></label><input type="datetime-local" class="form-control" id="appointmentDateTime" required></div><div class="form-group"><label class="form-label" for="appointmentProducts" data-i18n="products_used"></label><select class="form-control" id="appointmentProducts" multiple style="height: 120px;"></select></div><div class="form-group"><label class="form-label" for="appointmentPrice" data-i18n="service_price"></label><input type="number" class="form-control" id="appointmentPrice" min="0" step="0.01"></div><div class="form-group"><label class="form-label" for="appointmentNotes" data-i18n="notes"></label><textarea class="form-control" id="appointmentNotes" rows="3"></textarea></div><div class="form-actions"><button type="button" class="btn btn-outline" onclick="app.closeModal('addAppointmentModal')" data-i18n="cancel"></button><button type="submit" class="btn btn-primary" id="saveAppointmentButton" data-i18n="save_appointment"></button></div></form></div>`,
                    addInventoryModal: `<div class="modal-content"><div class="modal-header"><h3 class="modal-title" id="inventoryModalTitle"><i class="fas fa-box"></i> <span data-i18n="add_inventory_item"></span></h3><button type="button" class="close-modal" onclick="app.closeModal('addInventoryModal')">&times;</button></div><form id="inventoryForm"><input type="hidden" id="inventoryId"><div class="form-group"><label class="form-label" for="itemName" data-i18n="item_name"></label><input type="text" class="form-control" id="itemName" required></div><div class="form-group"><label class="form-label" for="itemCategory" data-i18n="category"></label><select class="form-control" id="itemCategory" required><option value="haircare" data-i18n="haircare"></option><option value="styling" data-i18n="styling"></option><option value="color" data-i18n="color"></option><option value="tools" data-i18n="tools"></option><option value="other" data-i18n="other"></option></select></div><div class="form-group"><label class="form-label" for="itemQuantity" data-i18n="quantity"></label><input type="number" class="form-control" id="itemQuantity" min="0" required></div><div class="form-group"><label class="form-label" for="itemAlert" data-i18n="low_stock_alert"></label><input type="number" class="form-control" id="itemAlert" min="1" value="5"></div><div class="form-group"><label class="form-label" for="itemSupplier" data-i18n="supplier"></label><input type="text" class="form-control" id="itemSupplier"></div><div class="form-actions"><button type="button" class="btn btn-outline" onclick="app.closeModal('addInventoryModal')" data-i18n="cancel"></button><button type="submit" class="btn btn-primary" id="saveInventoryButton" data-i18n="save_item"></button></div></form></div>`
                };
                for (const [id, content] of Object.entries(modals)) { document.getElementById(id).innerHTML = content; }
                
                document.getElementById('installPrompt').innerHTML = `<span data-i18n="install_prompt"></span><div style="display: flex; gap: 12px;"><button class="btn btn-success" id="installConfirmBtn"><i class="fas fa-download"></i> <span data-i18n="install_now"></span></button><button class="btn btn-outline" id="installDismissBtn"><span data-i18n="maybe_later"></span></button></div>`;
            }

            initTranslations() {
                this.translations = {
                     en: {"main_navigation":"Main Navigation","dashboard":"Dashboard","calendar":"Calendar","clients":"Clients","appointments":"All Appointments","inventory":"Inventory","quick_actions":"Quick Actions","add_client":"Add Client","schedule_appointment":"Schedule","tagline":"Professional Hairdresser Management System","install_app":"Install App","salon_overview":"Salon Overview","total_clients":"Total Clients","today_appointments":"Today's Appointments","low_stock":"Low Stock Items","monthly_revenue":"Completed This Month","appointments_for_date":"Appointments","add_appointment":"Add Appointment","client_management":"Client Management","new_client":"New Client","no_clients_yet":"No Clients Yet","build_client_database":"Start building your client database","add_first_client":"Add Your First Client","appointment_management":"All Appointments","new_appointment":"New Appointment","no_appointments_scheduled":"No Appointments Scheduled","schedule_first_appointment":"Schedule your first appointment","create_first_appointment":"Create First Appointment","inventory_management":"Inventory Management","new_item":"New Item","no_inventory_items":"No Inventory Items","track_supplies":"Track your products and supplies","add_first_item":"Add First Item","install_prompt":"Install HairSalon Pro for the ultimate experience?","install_now":"Install Now","maybe_later":"Maybe Later","add_new_client":"Add New Client","client_name":"Client Name","phone_number":"Phone Number","email_address":"Email Address","notes":"Notes","cancel":"Cancel","save_client":"Save Client","select_client":"Select Client","appointment_title":"Appointment Title","date_time":"Date & Time","products_used":"Products Used (Hold Ctrl/Cmd)","service_price":"Service Price ($)","save_appointment":"Save Appointment","add_inventory_item":"Add Inventory Item","item_name":"Item Name","category":"Category","haircare":"Haircare","styling":"Styling","color":"Color","tools":"Tools","other":"Other","quantity":"Quantity","low_stock_alert":"Low Stock Alert","supplier":"Supplier","save_item":"Save Item","for":"for","completed":"Completed","complete_appointment":"Complete Appointment","edit":"Edit","delete":"Delete","edit_client":"Edit Client","update_client":"Update Client","edit_appointment":"Edit Appointment","update_appointment":"Update Appointment","edit_inventory_item":"Edit Inventory Item","update_item":"Update Item","confirm_delete_client":"Are you sure you want to delete this client and all their appointments? This cannot be undone.","client_deleted_successfully":"Client deleted successfully!","confirm_delete_appointment":"Are you sure you want to delete this appointment?","appointment_deleted_successfully":"Appointment deleted successfully!","confirm_delete_item":"Are you sure you want to delete this inventory item?","item_deleted_successfully":"Inventory item deleted successfully!","install_success":"App installed successfully! Welcome!","install_dismissed":"Installation dismissed.","already_installed":"HairSalon Pro is already installed!","client_saved":"Client saved!","client_updated":"Client updated!","appointment_saved":"Appointment saved!","appointment_updated":"Appointment updated!","item_saved":"Inventory item saved!","item_updated":"Inventory item updated!","appointment_completed":"Appointment completed and stock updated!"}, 
                     es: {"main_navigation":"Navegación","dashboard":"Panel","calendar":"Calendario","clients":"Clientes","appointments":"Todas las Citas","inventory":"Inventario","quick_actions":"Acciones Rápidas","add_client":"Añadir Cliente","schedule_appointment":"Agendar","tagline":"Sistema Profesional de Gestión de Peluquería","install_app":"Instalar App","salon_overview":"Resumen del Salón","total_clients":"Total Clientes","today_appointments":"Citas de Hoy","low_stock":"Stock Bajo","monthly_revenue":"Completado (Mes)","appointments_for_date":"Citas","add_appointment":"Añadir Cita","client_management":"Gestión de Clientes","new_client":"Nuevo Cliente","no_clients_yet":"Aún No Hay Clientes","build_client_database":"Empieza a construir tu base de clientes","add_first_client":"Añade tu Primer Cliente","appointment_management":"Todas las Citas","new_appointment":"Nueva Cita","no_appointments_scheduled":"No Hay Citas Programadas","schedule_first_appointment":"Agenda tu primera cita","create_first_appointment":"Crear Primera Cita","inventory_management":"Gestión de Inventario","new_item":"Nuevo Artículo","no_inventory_items":"No Hay Artículos","track_supplies":"Controla tus productos","add_first_item":"Añadir Primer Artículo","install_prompt":"¿Instalar HairSalon Pro para la mejor experiencia?","install_now":"Instalar Ahora","maybe_later":"Quizás Más Tarde","add_new_client":"Añadir Nuevo Cliente","client_name":"Nombre del Cliente","phone_number":"Teléfono","email_address":"Correo Electrónico","notes":"Notas","cancel":"Cancelar","save_client":"Guardar Cliente","select_client":"Seleccionar Cliente","appointment_title":"Título de la Cita","date_time":"Fecha y Hora","products_used":"Productos Usados (Ctrl/Cmd)","service_price":"Precio (€)","save_appointment":"Guardar Cita","add_inventory_item":"Añadir Artículo","item_name":"Nombre del Artículo","category":"Categoría","haircare":"Cuidado Capilar","styling":"Estilismo","color":"Color","tools":"Herramientas","other":"Otro","quantity":"Cantidad","low_stock_alert":"Alerta de Stock Bajo","supplier":"Proveedor","save_item":"Guardar Artículo","for":"para","completed":"Completada","complete_appointment":"Completar Cita","edit":"Editar","delete":"Eliminar","edit_client":"Editar Cliente","update_client":"Actualizar","edit_appointment":"Editar Cita","update_appointment":"Actualizar","edit_inventory_item":"Editar Artículo","update_item":"Actualizar","confirm_delete_client":"¿Seguro que quieres eliminar este cliente y todas sus citas? Esta acción no se puede deshacer.","client_deleted_successfully":"¡Cliente eliminado!","confirm_delete_appointment":"¿Seguro que quieres eliminar esta cita?","appointment_deleted_successfully":"¡Cita eliminada!","confirm_delete_item":"¿Seguro que quieres eliminar este artículo?","item_deleted_successfully":"¡Artículo eliminado!","install_success":"¡App instalada! ¡Bienvenido/a!","install_dismissed":"Instalación cancelada.","already_installed":"¡HairSalon Pro ya está instalado!","client_saved":"¡Cliente guardado!","client_updated":"¡Cliente actualizado!","appointment_saved":"¡Cita guardada!","appointment_updated":"¡Cita actualizada!","item_saved":"¡Artículo guardado!","item_updated":"¡Artículo actualizado!","appointment_completed":"¡Cita completada y stock actualizado!"},
                     ru: {"main_navigation":"Навигация","dashboard":"Панель","calendar":"Календарь","clients":"Клиенты","appointments":"Все записи","inventory":"Инвентарь","quick_actions":"Действия","add_client":"Добавить клиента","schedule_appointment":"Запланировать","tagline":"Профессиональная система управления салоном","install_app":"Установить","salon_overview":"Обзор салона","total_clients":"Всего клиентов","today_appointments":"Записи сегодня","low_stock":"Мало товара","monthly_revenue":"Завершено (Месяц)","appointments_for_date":"Записи","add_appointment":"Добавить запись","client_management":"Управление клиентами","new_client":"Новый клиент","no_clients_yet":"Клиентов еще нет","build_client_database":"Создайте свою базу клиентов","add_first_client":"Добавить первого клиента","appointment_management":"Все записи","new_appointment":"Новая запись","no_appointments_scheduled":"Нет записей","schedule_first_appointment":"Запланируйте встречу","create_first_appointment":"Создать первую запись","inventory_management":"Управление инвентарем","new_item":"Новый товар","no_inventory_items":"Нет товаров","track_supplies":"Отслеживайте свои продукты","add_first_item":"Добавить первый товар","install_prompt":"Установить HairSalon Pro для лучшего опыта?","install_now":"Установить","maybe_later":"Позже","add_new_client":"Новый клиент","client_name":"Имя клиента","phone_number":"Телефон","email_address":"Эл. почта","notes":"Заметки","cancel":"Отмена","save_client":"Сохранить","select_client":"Выберите клиента","appointment_title":"Название","date_time":"Дата и время","products_used":"Продукты (Ctrl/Cmd)","service_price":"Цена (₽)","save_appointment":"Сохранить","add_inventory_item":"Добавить товар","item_name":"Название","category":"Категория","haircare":"Уход","styling":"Стайлинг","color":"Окрашивание","tools":"Инструменты","other":"Другое","quantity":"Кол-во","low_stock_alert":"Оповещение о запасе","supplier":"Поставщик","save_item":"Сохранить","for":"для","completed":"Завершено","complete_appointment":"Завершить","edit":"Изменить","delete":"Удалить","edit_client":"Изменить клиента","update_client":"Обновить","edit_appointment":"Изменить запись","update_appointment":"Обновить","edit_inventory_item":"Изменить товар","update_item":"Обновить","confirm_delete_client":"Удалить клиента и все его записи? Отменить будет нельзя.","client_deleted_successfully":"Клиент удален!","confirm_delete_appointment":"Удалить эту запись?","appointment_deleted_successfully":"Запись удалена!","confirm_delete_item":"Удалить этот товар?","item_deleted_successfully":"Товар удален!","install_success":"Приложение установлено! Добро пожаловать!","install_dismissed":"Установка отменена.","already_installed":"HairSalon Pro уже установлено!","client_saved":"Клиент сохранен!","client_updated":"Клиент обновлен!","appointment_saved":"Запись сохранена!","appointment_updated":"Запись обновлена!","item_saved":"Товар сохранен!","item_updated":"Товар обновлен!","appointment_completed":"Запись завершена, остатки обновлены!"},
                     he: {"main_navigation":"ניווט","dashboard":"לוח בקרה","calendar":"לוח שנה","clients":"לקוחות","appointments":"כל הפגישות","inventory":"מלאי","quick_actions":"פעולות","add_client":"הוסף לקוח","schedule_appointment":"קבע פגישה","tagline":"מערכת ניהול מקצועית למספרה","install_app":"התקן","salon_overview":"סקירת סלון","total_clients":"סה\"כ לקוחות","today_appointments":"פגישות להיום","low_stock":"מלאי נמוך","monthly_revenue":"הושלם החודש","appointments_for_date":"פגישות","add_appointment":"הוסף פגישה","client_management":"ניהול לקוחות","new_client":"לקוח חדש","no_clients_yet":"אין לקוחות","build_client_database":"התחל לבנות את מאגר הלקוחות","add_first_client":"הוסף לקוח ראשון","appointment_management":"כל הפגישות","new_appointment":"פגישה חדשה","no_appointments_scheduled":"אין פגישות","schedule_first_appointment":"קבע את פגישתך הראשונה","create_first_appointment":"צור פגישה ראשונה","inventory_management":"ניהול מלאי","new_item":"פריט חדש","no_inventory_items":"אין פריטים","track_supplies":"עקוב אחר המוצרים","add_first_item":"הוסף פריט ראשון","install_prompt":"להתקין את HairSalon Pro לחוויה אולטימטיבית?","install_now":"התקן עכשיו","maybe_later":"אולי מאוחר יותר","add_new_client":"הוסף לקוח חדש","client_name":"שם הלקוח","phone_number":"טלפון","email_address":"דוא\"ל","notes":"הערות","cancel":"ביטול","save_client":"שמור","select_client":"בחר לקוח","appointment_title":"כותרת","date_time":"תאריך ושעה","products_used":"מוצרים (Ctrl/Cmd)","service_price":"מחיר (₪)","save_appointment":"שמור","add_inventory_item":"הוסף פריט","item_name":"שם הפריט","category":"קטגוריה","haircare":"טיפוח שיער","styling":"עיצוב","color":"צבע","tools":"כלים","other":"אחר","quantity":"כמות","low_stock_alert":"התראת מלאי נמוך","supplier":"ספק","save_item":"שמור","for":"עבור","completed":"הושלם","complete_appointment":"השלם","edit":"ערוך","delete":"מחק","edit_client":"ערוך לקוח","update_client":"עדכן","edit_appointment":"ערוך פגישה","update_appointment":"עדכן","edit_inventory_item":"ערוך פריט","update_item":"עדכן","confirm_delete_client":"למחוק את הלקוח וכל פגישותיו? לא ניתן לשחזר.","client_deleted_successfully":"הלקוח נמחק!","confirm_delete_appointment":"למחוק את הפגישה?","appointment_deleted_successfully":"הפגישה נמחקה!","confirm_delete_item":"למחוק את הפריט?","item_deleted_successfully":"הפריט נמחק!","install_success":"האפליקציה הותקנה! ברוכים הבאים!","install_dismissed":"ההתקנה בוטלה.","already_installed":"HairSalon Pro כבר מותקן!","client_saved":"הלקוח נשמר!","client_updated":"הלקוח עודכן!","appointment_saved":"הפגישה נשמרה!","appointment_updated":"הפגישה עודכנה!","item_saved":"הפריט נשמר!","item_updated":"הפריט עודכן!","appointment_completed":"הפגישה הושלמה והמלאי עודכן!"}
                };
            }

            // --- MAIN LOGIC ---
            refreshAll() { this.updateDashboardStats(); this.renderCalendar(); this.renderClients(); this.renderAllAppointmentsList(); this.renderInventory(); this.renderAppointmentsForSelectedDay(); }
            showSection(sectionId) { document.querySelectorAll('.section.active').forEach(s => s.classList.remove('active')); document.getElementById(sectionId).classList.add('active'); document.querySelectorAll('.nav-link.active').forEach(l => l.classList.remove('active')); document.querySelector(`.nav-link[data-section="${sectionId}"]`).classList.add('active'); }
            
            // --- CALENDAR LOGIC ---
            renderCalendar() {
                const month = this.currentDate.getMonth(), year = this.currentDate.getFullYear();
                document.getElementById('calendarMonthYear').textContent = new Date(year, month).toLocaleString(this.currentLanguage, { month: 'long', year: 'numeric' });
                const firstDayOfMonth = (new Date(year, month, 1).getDay() + 6) % 7; // Monday is 0
                const daysInMonth = new Date(year, month + 1, 0).getDate();
                const calendarDays = document.getElementById('calendarDays');
                calendarDays.innerHTML = '';
                for (let i = 0; i < firstDayOfMonth; i++) { calendarDays.innerHTML += `<div class="other-month"></div>`; }
                const today = new Date();
                const appointmentsOnDates = new Set(this.appointments.map(a => a.dateTime.split('T')[0]));
                for (let day = 1; day <= daysInMonth; day++) {
                    const dayEl = document.createElement('div');
                    dayEl.className = 'calendar-day';
                    dayEl.textContent = day;
                    const thisDate = new Date(year, month, day);
                    const thisDateString = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                    if (today.getFullYear() === year && today.getMonth() === month && today.getDate() === day) dayEl.classList.add('today');
                    if (this.selectedDate.getFullYear() === year && this.selectedDate.getMonth() === month && this.selectedDate.getDate() === day) dayEl.classList.add('selected');
                    if (appointmentsOnDates.has(thisDateString)) dayEl.innerHTML += `<span class="event-dot"></span>`;
                    dayEl.addEventListener('click', () => { this.selectedDate = thisDate; this.refreshAll(); });
                    calendarDays.appendChild(dayEl);
                }
                const weekdaysEl = document.getElementById('calendarWeekdays');
                if (weekdaysEl.children.length === 0) {
                     const weekdays = [...Array(7).keys()].map(i => new Date(2024, 0, i + 1).toLocaleString(this.currentLanguage, { weekday: 'short' })); // Start from Monday
                     weekdaysEl.innerHTML = weekdays.map(day => `<div class="calendar-weekday">${day}</div>`).join('');
                }
            }

            renderAppointmentsForSelectedDay() {
                const listEl = document.getElementById('selectedDayAppointmentsList');
                const t = this.translations[this.currentLanguage];
                const selectedDateString = this.selectedDate.toLocaleDateString(this.currentLanguage, { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
                document.getElementById('selectedDayTitle').querySelector('span').textContent = `${t['appointments_for_date']} - ${selectedDateString}`;
                const appointmentsForDay = this.appointments.filter(a => new Date(a.dateTime).toDateString() === this.selectedDate.toDateString());
                this.renderAppointments(appointmentsForDay, 'selectedDayAppointmentsList', true);
            }

            // --- DATA RENDERING ---
            updateDashboardStats() {
                document.getElementById('totalClients').textContent = this.clients.length;
                const today = new Date().toDateString();
                document.getElementById('todayAppointments').textContent = this.appointments.filter(a => new Date(a.dateTime).toDateString() === today).length;
                const currentMonth = new Date().toISOString().slice(0, 7);
                document.getElementById('monthlyRevenue').textContent = `$${this.appointments.filter(a=>a.dateTime.startsWith(currentMonth)&&a.status==='completed'&&a.price).reduce((s,a)=>s+parseFloat(a.price),0).toFixed(2)}`;
                document.getElementById('lowStockItems').textContent = this.inventory.filter(i=>parseInt(i.quantity)<=parseInt(i.alert)).length;
            }
            renderAllAppointmentsList() { this.renderAppointments(this.appointments, 'appointmentsList'); }
            renderClients() { /* Renders all clients in #clientsList */ }
            renderInventory() { /* Renders all items in #inventoryList */ }

            renderAppointments(list, targetId, isForDayView = false) {
                const listEl = document.getElementById(targetId);
                const t = this.translations[this.currentLanguage];
                const now = new Date();

                if (list.length === 0) {
                    const emptyStateHTML = `<div class="empty-state"><i class="fas fa-calendar-times"></i><h3>${isForDayView ? t['no_appointments_for_day'] || 'No appointments for this day.' : t['no_appointments_scheduled']}</h3></div>`;
                    listEl.innerHTML = emptyStateHTML;
                    return;
                }

                listEl.innerHTML = list.map(app => {
                    const appDate = new Date(app.dateTime);
                    const timeString = appDate.toLocaleTimeString(this.currentLanguage, { hour: '2-digit', minute: '2-digit' });
                    const productNames = (app.productsUsed || []).map(pid => this.inventory.find(item => item.id === pid)?.name).filter(Boolean).join(', ');
                    const completeButton = app.status !== 'completed' && appDate <= now ? `<button class="btn btn-secondary btn-sm" onclick="app.completeAppointment('${app.id}')" title="${t['complete_appointment']}"><i class="fas fa-check"></i></button>` : '';

                    return `<div class="data-item appointment-item ${app.status === 'completed' ? 'completed' : ''}">
                                <div class="data-item-content">
                                    <h4><i class="fas fa-clock"></i> ${timeString} - ${app.title} ${app.status === 'completed' ? `<span class="status-badge">${t['completed']}</span>` : ''}</h4>
                                    <p><i class="fas fa-user"></i> ${app.clientName} | <i class="fas fa-dollar-sign"></i> ${app.price || '0.00'}</p>
                                    ${productNames ? `<div class="products-used"><i class="fas fa-spray-can"></i> ${productNames}</div>` : ''}
                                </div>
                                <div class="data-item-actions">
                                    ${completeButton}
                                    <button class="btn btn-outline btn-sm" onclick="app.editAppointment('${app.id}')" title="${t['edit']}"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-danger btn-sm" onclick="app.deleteAppointment('${app.id}')" title="${t['delete']}"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>`;
                }).join('');
            }

            // --- DATA MANIPULATION (save, edit, delete) ---
            saveClient(data){/*...*/} editClient(id){/*...*/} deleteClient(id){/*...*/}
            saveAppointment(data){/*...*/} editAppointment(id){/*...*/} deleteAppointment(id){/*...*/}
            saveInventory(data){/*...*/} editInventoryItem(id){/*...*/} deleteInventoryItem(id){/*...*/}
            completeAppointment(id){/*...*/}
            
            // --- UI & PWA ---
            translateUI() {/*...*/} showNotification(key, isError=false){/*...*/} 
            openModal(id){/*...*/} closeModal(id){/*...*/}
            handleBeforeInstallPrompt(e){/*...*/} handleInstallConfirmed(){/*...*/} handleAppInstalled(){/*...*/}

            // --- EVENT LISTENERS ---
            setupEventListeners() {
                document.querySelectorAll('.nav-link[data-section]').forEach(link => link.addEventListener('click', () => this.showSection(link.dataset.section)));
                document.getElementById('languageSelect').addEventListener('change', e => this.translateUI(e.target.value));
                document.getElementById('quickAddClient').addEventListener('click', () => this.openModal('addClientModal'));
                document.getElementById('quickAddAppointment').addEventListener('click', () => this.openModal('addAppointmentModal'));
                document.getElementById('prevMonthBtn').addEventListener('click', () => { this.currentDate.setMonth(this.currentDate.getMonth() - 1); this.renderCalendar(); });
                document.getElementById('nextMonthBtn').addEventListener('click', () => { this.currentDate.setMonth(this.currentDate.getMonth() + 1); this.renderCalendar(); });
                document.getElementById('addAppointmentForSelectedDay').addEventListener('click', () => {
                    this.openModal('addAppointmentModal');
                    const dateString = `${this.selectedDate.getFullYear()}-${String(this.selectedDate.getMonth() + 1).padStart(2, '0')}-${String(this.selectedDate.getDate()).padStart(2, '0')}T12:00`;
                    document.getElementById('appointmentDateTime').value = dateString;
                });
                
                // PWA listeners
                window.addEventListener('beforeinstallprompt', e => this.handleBeforeInstallPrompt(e));
                window.addEventListener('appinstalled', () => this.handleAppInstalled());
                document.getElementById('installConfirmBtn').addEventListener('click', () => this.handleInstallConfirmed());
                document.getElementById('installDismissBtn').addEventListener('click', () => document.getElementById('installPrompt').classList.remove('show'));

                // Form submission listeners
                document.getElementById('clientForm').addEventListener('submit', e => { e.preventDefault(); /* ... */ });
                document.getElementById('appointmentForm').addEventListener('submit', e => { e.preventDefault(); /* ... */ });
                document.getElementById('inventoryForm').addEventListener('submit', e => { e.preventDefault(); /* ... */ });
            }
        }

        document.addEventListener('DOMContentLoaded', () => { window.app = new HairSalonPro(); });
    </script>
</body>
</html>

